<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
	<meta name="monetization" content="$ilp.uphold.com/qwqgDjZYG8KL">
	<style>
        #yy,.eb,body,html{position:relative}#d,body{background:0 0}#h .eb:hover,button{cursor:pointer}*{font-family:"Comic Sans MS",sans-serif;text-align:center;user-select:none;outline:0;font-size:16px;transition:all 250ms;scrollbar-width:thin;scrollbar-color:#1b1b1b transparent}:focus{outline:0}body,html{width:100%;height:100%;margin:0;overflow:hidden}html{background:#292929;line-height:1.15;-webkit-text-size-adjust:100%}body{max-width:500px;display:flex;justify-content:center;flex-direction:column;margin:0 auto}body>div{margin:1rem}h1{font-size:1.5em;margin:.5em 0 1.2em}b,strong{font-weight:bolder}button{font-family:inherit;line-height:1.15;margin:0;overflow:visible;text-transform:none}button::-moz-focus-inner{border-style:none;padding:0}.oo{height:450px;min-height:450px;max-height:450px}.fc{width:0;height:0;border-left:6px solid transparent;border-right:6px solid transparent;border-bottom:8px solid #fff;margin-top:6px;margin-right:1px;display:none}.n .bd,.n .fc,.passive-active .bd,.passive-active .fc{display:inherit;color:#777;border-bottom-color:#aaa}.n .bd,.n .fc{color:#ddd;border-bottom-color:#fff}.p{background:#222;box-shadow:0 0 4px #000;padding:1rem;border:0;color:#fff;margin-bottom:1rem}#moralityInfo,#statInfo,#trophyInfo,#unitInfo{position:absolute;right:1rem;top:1rem;width:1.75rem;height:1.75rem;display:flex;box-shadow:0 0 4px #000;background:#202020;padding:.5rem}#trophyInfo{top:4rem}#unitInfo{right:8rem;top:1rem}#statInfoContent{text-align:left}#bigPopUp #statInfoContent p{margin:0;text-align:left;border-bottom:1px solid #333;padding-bottom:5px;padding-top:5px}#moralityInfo svg,#statInfo svg,#trophyInfo svg,#unitInfo svg{fill:#7a7a7a}#unitDescription{display:flex;flex-direction:column;justify-content:center;align-items:center}#unitDescription>div,.eb{flex-direction:column;display:flex}#unitDescription>div{box-shadow:0 0 10px #222;justify-content:center;align-items:center;margin-bottom:2rem;padding-top:1rem;width:100%}.tippy-box{background-color:#292929;box-shadow:0 0 10px #111}.unitDescriptionRow{display:flex;margin-bottom:2rem;flex-wrap:wrap;justify-content:center;padding-bottom:1rem}#bigPopUp #unitDescription h1,#nav,.unitDescriptionRow:last-of-type{margin-bottom:0}.unitDescriptionRow>div{width:45%}#enemy .eb span,#nav a svg{margin-bottom:5px}#bigPopUp #unitDescription p{margin-top:0}.unitDescriptionIcon{fill:#fff;width:40px;display:flex}.unitDescriptionAttack,.unitDescriptionDamage,.unitDescriptionDefense,.unitDescriptionHealth,.unitDescriptionSpeed,.unitDescriptionTime{width:55px;display:flex;justify-content:flex-start;align-items:center}.unitDescriptionHealth{width:65px}.unitDescriptionSpeed{width:48px}.unitDescriptionDamage{width:85px}.unitDescriptionTime{width:64px}.unitDescriptionAttack svg,.unitDescriptionDamage svg,.unitDescriptionDefense svg,.unitDescriptionHealth svg,.unitDescriptionSpeed svg,.unitDescriptionTime svg{padding:5px 4px 5px 10px;max-width:23px}#nav{min-height:60px;display:flex}button{font-size:1.5rem;width:100%}button:hover{box-shadow:0 0 5px 2px #111}.eb{align-items:center;padding:.5rem}.eb svg{transition:none}#yy{display:flex;flex-direction:column;height:100%;max-height:600px}#h .eb.not:hover,#nav a{cursor:default}#h .eb.not .c{height:40px}#g,#ss,.c{height:100%}#h .eb.not .c svg{width:30px}#h .eb.n svg,#h .eb:hover svg{transform:scale(1.15,1.15)}#h .eb:hover svg{filter:drop-shadow(0 0 2px #eee)}#h .eb.not:hover>svg{transform:none;filter:none;fill:#aaa}#h .eb span{margin-top:5px}#ll,#stage{margin-bottom:1.5rem}.ba{position:absolute;color:#da3e3f;font-weight:700}#battle,#morality .p,#nav a,#xx{position:relative}#h .ba{top:48px}.af{opacity:.4}#enemy,#h{display:flex;justify-content:center}#enemy{margin-top:3rem;margin-bottom:2rem}#xx div svg,svg{width:40px}#h svg{fill:#fff}#enemy svg{fill:#da3f3f}#battle{display:flex;flex-direction:column}#xx{display:flex;justify-content:space-between;min-height:40px}#xx div{display:flex;align-items:center}#stage,#xx div div{flex-direction:column}#ww{margin-left:8px}#xx #ww{align-items:flex-start}#vv{margin-left:3px}#stage{display:flex;align-items:flex-start;margin-left:1rem}#a,#rr,#s{font-size:1.25rem}#rr{font-size:1.5rem;margin-top:.75rem}#b,#f,#not-generating,.bd{font-size:.75rem;color:#aaa;margin-top:3px}#nav a{text-decoration:none;color:#fff;display:flex;flex-direction:column;align-items:center;width:25%;font-size:.8rem}#nav a.k{cursor:pointer}#nav a.k:hover svg,#nav a.n svg{transform:scale(1.2,1.2)}#clear-colors:hover,#morality .p .color-soul:hover{transform:scale(1.2)}#nav a svg{fill:#fff;width:34px;padding:3px;min-height:34px}#z.k:hover,#z.n{color:#e46262}#z.k:hover svg,#z.n svg{fill:#e46262}#gg.k:hover,#gg.n{color:#81c7ff}#gg.k:hover svg,#gg.n svg{fill:#81c7ff}#aa.k:hover,#aa.n{color:#b5664a}#aa.k:hover svg,#aa.n svg{fill:#b5664a}#aa svg{width:36px;padding:2px}#ff.k:hover,#ff.n{color:#e0a656}#ff.k:hover svg,#ff.n svg{fill:#e0a656}#info.k:hover,#info.n{color:#17a2b8}#info.k:hover svg,#info.n svg{fill:#17a2b8}#morality .p{width:100%}#morality .p .color-souls{width:100%;display:flex;justify-content:space-evenly}.color-soul-notifications{position:absolute;top:3rem;opacity:0;left:2rem;display:flex;justify-content:center;align-items:center;color:#aaa}#morality .p .color-soul,#zz{display:flex;flex-direction:column}.souls-gained-notification{color:#ddd}.color-soul-notifications .color-soul-notification svg{width:24px}#skills>div,.c{width:100%}#morality .p .color-soul{transition:all 250ms;cursor:pointer}#morality .p .color-soul span{margin-top:.5rem}.bd{margin-top:7px;display:none}.redColorText{color:#d64242}.greenColorText{color:#48b138}.blueColorText{color:#5373d8}#zz{background:#a03536;box-shadow:0 0 5px 0 #a03536;color:#fff;align-items:center;min-height:50px}#q,#skills>div{flex-direction:column;display:flex}#zz:hover{background:#da3e3f;box-shadow:0 0 5px 0 #da3e3f}#zz.bc{background:#222;box-shadow:0 0 5px 0 #111}#zz.bc:hover{background:#a03536;box-shadow:0 0 5px 0 #a03536}#zz .info,.info{font-size:.75rem;color:#ddd;margin-top:3px}#q{min-height:125px}#g.done a,#t button{justify-content:space-between;height:50px}#t{display:flex;padding:0 .5rem}#t button{padding:1rem 1.5rem 1rem .75rem;margin:1rem .5rem;display:flex;align-items:center;color:#aaa;background:#1d1d1d;position:relative}#t svg,.c{position:absolute}#t svg{width:16px;border:1px solid #aaa;padding:6px;fill:#aaa;box-shadow:0 0 3px #aaa;border-radius:4px;right:.65rem}#q.done button{color:#fff;cursor:default;padding:1rem 1rem 1rem .75rem}#q.done strong{margin-right:0}#q.done svg{display:none}#g,#g a.ac,#g.done a,#g.done a div,.c{display:flex}#q.done button:hover{box-shadow:0 0 4px #000}#t button:hover{color:#fff}#t button:hover svg{fill:#fff;border-color:#fff}#t button strong{font-size:1rem;margin-right:1.75rem}#t button span{margin-right:1rem;color:#fff}.c{flex-direction:column;background:rgb(34 34 34 / 90%);justify-content:center;align-items:center;box-shadow:0 0 11px #222;text-shadow:0 0 5px #fff;padding:.25rem}#skills,#skills .c{position:relative}#g a,#skills .c{background:#1e1e1e;box-shadow:0 0 4px #000}#nav a .c svg,.c svg{width:20px;fill:#fff;filter:drop-shadow(0 0 5px #fff)}.c span{font-size:.75rem}#skills .c svg{width:50px;filter:drop-shadow(0 0 2px #fff)}#skills .c span{font-size:1.5rem;margin-top:.75rem;text-shadow:0 0 2px #fff}#g{flex-wrap:wrap;justify-content:space-between;padding:.5rem;align-content:flex-start}#g.lock{padding:1rem}#g a{margin:.5rem;flex:1 1 40%;padding:.5rem 0 .6rem;text-decoration:none;color:#aaa;max-width:calc(50% - 1rem)}#g.done a,#j,#l{padding:0}#g.done a{align-items:center;color:#fff;cursor:default}#g.done a>span{margin-left:1rem}#g.done a div{flex-direction:column;padding-left:.75rem;align-items:self-start}#g.done a div.cost{color:#888;border-left:1px solid #333;margin-right:1rem;padding-left:1rem;align-items:center}#g.done a div .skillStats{font-size:.65rem;margin-bottom:2px;color:#888}#g a.open:hover strong,#g.done a.open div{color:#fff}.skillLevelInfo{font-size:.65rem}#g a.ac{flex-direction:column}#e,.ee{display:none}#g a.ac span{font-size:.7rem;margin-top:3px}#g.done a span.buy{margin-top:.25rem;font-size:.75rem}#g a.open{cursor:pointer}#g a.open:hover{box-shadow:0 0 5px 2px #111;transform:scale(1.05,1.05)}#g a.ea,#g a:hover{transform:scale(1,1)}#pp,#qq{font-size:1.5rem;margin:.5rem 0}.ee{background:#fff;width:6px;height:6px;border-radius:100%;position:absolute;top:-6px;box-shadow:0 0 5px #fff}#nav a.dd .ee{display:block}#nav a.cc .ee{display:block;background:#4d84b9;box-shadow:0 0 5px #4d84b9}#nav a.bb .ee{display:block;background:#da3e3f;box-shadow:0 0 5px #da3e3f}#g a.ea:hover{box-shadow:0 0 4px #000;cursor:default}#g a.ea{justify-content:center}#g a.ea svg{width:30px;fill:#aaa}#g a.ea span{margin-left:.25rem;color:#aaa}#g a.ea:hover span{color:#aaa}#info-content{flex-direction:column}#info-content *{box-sizing:border-box;color:#ccc}#info-content #info-tabs{padding-top:0}#info-content textarea{width:100%;height:120px;background:#313131;resize:none;box-shadow:inset 0 0 4px #000;border:0;color:#aaa;text-align:left;padding:.5rem .75rem}#info-content #copy-save,#info-content #hard-reset-game,#info-content #load-game{width:100%;padding:.75rem;background:#191919;margin-top:.5rem;display:block;color:#ccc;text-decoration:none;box-shadow:0 0 4px #000;margin-bottom:1rem}#info-content #hard-reset-game{color:#fff;background:#a03536;box-shadow:0 0 4px #a03536}#info-content>div{width:100%;padding:1rem 2rem;overflow-y:auto}#info-content #info-tabs{overflow:inherit;justify-content:space-evenly;display:flex}#info-content #info-tabs a{box-shadow:0 0 4px #000;padding:.5rem 1rem;background:#222;color:#fff;text-decoration:none;opacity:.5;transition:all 250ms}#info-content #info-tabs a.active,#info-content #info-tabs a:hover{opacity:1;color:#4d84b9}#info-content p{text-align:left;margin-top:1.25rem;line-height:1.5}#info-content li{text-align:left;margin-top:5px}#info-content a{color:#4d84b9}#nn{position:relative;flex-direction:column}#nn>div{width:100%;padding:1rem;overflow-y:auto;box-sizing:border-box}#nn #trophy-tabs{overflow:inherit;justify-content:flex-start;display:flex;padding-top:0}#nn #trophy-tabs a{box-shadow:0 0 4px #000;padding:.5rem 1rem;background:#222;color:#fff;text-decoration:none;opacity:.5;transition:all 250ms;margin-right:1rem}#nn #trophy-tabs .tier-locked{cursor:not-allowed;padding-left:.75rem;justify-content:center;align-items:center;display:flex}#nn #trophy-tabs .tier-locked svg{width:20px;height:20px;fill:#aaa;margin-right:.25rem}#e,#l{position:absolute;height:50px;border:0;box-shadow:0 0 4px #000}#nn #trophy-tabs a.active,#nn #trophy-tabs a:hover{opacity:1;color:#4d84b9}#nn #trophy-tabs a.active.tier-locked,#nn #trophy-tabs a.tier-locked:hover{opacity:.5;color:#fff}#j li,.ae{opacity:.75}#d span,#e,#e .info,#ll{color:#aaa}#j{display:flex;flex-wrap:wrap;margin:0;list-style:none;justify-content:center}#j li{width:32px;height:32px;padding:10px;box-shadow:0 0 4px #000;background:#1f1f1f;margin:7px;cursor:pointer}#j li:hover{transform:scale(1.1,1.1)}#j li.ad:hover{opacity:1}#j li svg{filter:blur(1px)}#j li.ad svg{filter:none}#j svg{fill:#fff;width:auto}#e{flex-direction:column;top:0;width:140px;margin-left:-70px;left:50%;justify-content:center;align-items:center;margin-top:11px;background:#1f1f1f}#d,.ae{left:0}#e:hover,#ll strong{color:#fff}#e:hover{transform:scale(1.075,1.075)}#d{box-shadow:none;position:absolute;top:16px;height:42px;text-shadow:0 0 5px #aaa}#d span{margin-top:7px}#d svg{fill:#aaa;filter:drop-shadow(0 0 5px #aaa)}#mm{margin-bottom:.25rem}#ll{font-size:.8rem}#l{display:flex;top:1rem;right:1rem;width:100px;justify-content:space-around;align-items:center;background:#202020}#m,.ae{height:100%;position:absolute}#m{background:#202020;opacity:.9;width:100%}#l:hover{transform:scale(1.1,1.1)}#l:active,#l:hover,#l:link,#l:visited{color:#202020!important}#m svg{fill:#555;width:30px;margin-top:10px}#l:hover #m svg{fill:#fff;filter:drop-shadow(0 0 5px #fff)}#tt{font-size:2.3rem;margin-top:-5px}.i #y{font-size:2.2rem}.i #r{font-size:2.1rem}.i #d,.i .c{font-size:1.5rem;text-shadow:none}.i #d{top:14px}.i .c{background:rgb(34 34 34 / 95%)}.i .c span{margin-top:5px}.i .eb,.i .eb strong{font-size:2.5rem;text-shadow:0 2px 10px #000}.i .eb span{font-size:1rem}.i #j li{font-size:1.5rem}.i #j li span{filter:blur(1px);font-size:1.75rem}.i #j li.ad span{filter:none;font-size:1.75rem}.i #nav a strong{font-size:2.2rem;margin-bottom:5px;text-shadow:0 2px 10px #000}.i #g .c{font-size:5rem}.i #h .eb span{margin-top:8px}.ae{top:0;width:100%;background:#222;box-shadow:0 0 5px #222}.ad .ae{display:none}@keyframes float{0%,100%{transform:rotate(0)}25%{transform:rotate(5deg)}75%{transform:rotate(-5deg)}}.special{box-shadow:0 0 10px #999!important}#clear-colors,#player-unit-to-uprade{box-shadow:0 0 4px #000;background:#1f1f1f}.special span,.special svg{animation:float 3s linear infinite}::-webkit-scrollbar{width:7px}::-webkit-scrollbar-track{background:0 0}::-webkit-scrollbar-thumb{background:#1b1b1b;border-radius:3px;border:3px solid transparent}.o{color:#666;text-decoration:none;padding:.25rem;border:1px solid #666;display:inline-block;width:40px}.o.n{color:#fff;border-color:#fff}#bigPopUp,#jj,#popUpConfirmation{flex-direction:column;position:absolute;top:50%;left:50%;width:320px;margin-left:-160px;margin-top:-80px;padding:0;align-items:center;background:#292929;box-shadow:0 1px 5px 3px #171717}#bigPopUp{width:450px;margin-left:-225px;margin-top:-200px}#bigPopUp p,#jj p,#popUpConfirmation p{margin:1.5rem;line-height:1.75}#bigPopUp p{margin:1.25rem}#bigPopUpContent{height:310px;overflow-y:auto;max-width:100vw}#player-unit-to-uprade{width:200px;height:110px;display:flex;justify-content:center;align-items:center;margin:1.5rem auto 0;flex-direction:column;position:relative}#player-unit-to-uprade strong{font-size:2.5rem}#clear-colors{width:40px;height:40px;position:absolute;right:3rem;top:14.25rem;display:flex;justify-content:center;align-items:center;transition:all 250ms;cursor:pointer}#clear-colors svg{width:30px;margin-top:-5px}#select-unit-to-upgrade{display:flex;justify-content:space-evenly;align-items:center;margin-top:1rem;margin-bottom:1rem}#player-unit-damage-bonus{margin-top:.5rem;font-size:.8rem;display:flex;justify-content:center;align-items:center}#player-unit-damage-bonus .color-amount{display:flex;justify-content:center;align-items:center;margin:0 .25rem}#player-unit-damage-bonus.max-color #max-color,#player-unit-damage-bonus.max-color #max-color-span{display:inherit}#player-unit-damage-bonus #max-color,#player-unit-damage-bonus #max-color-span{position:absolute;transform:rotate(-45deg);color:#ddd;filter:drop-shadow(0 0 5px #000) contrast(.5) brightness(1.5);display:none}#player-unit-damage-bonus #max-color{top:0;font-size:1.75rem;left:-1rem}#player-unit-damage-bonus #max-color-span{top:1.5rem;font-size:.8rem;left:.5rem}#player-unit-damage-bonus .color-amount svg{width:1.5rem;margin-right:.25rem}#select-unit-to-upgrade .upgradable-unit{display:flex;flex-direction:column;transition:all 250ms;cursor:pointer}#select-unit-to-upgrade .upgradable-unit strong{display:flex;flex-direction:column;transition:all 250ms;cursor:pointer;font-size:2rem}#select-unit-to-upgrade .upgradable-unit:hover{transform:scale(1.2)}#select-unit-to-upgrade .upgradable-unit .be{margin-top:.5rem}#bigPopUp button,#jj button,#popUpConfirmation button{width:auto;padding:.5rem 1rem;background:#444;outline:0;border:0;color:#fff;box-shadow:0 0 5px #111;margin-bottom:1.5rem;font-size:.8rem}@media (max-width:500px){body{justify-content:flex-end}#yy{margin:0 0 1.75rem}}@media (max-width:460px){#e .info,.skillLevelInfo{display:none}#e{width:80px;margin-left:-40px;height:40px;margin-top:17px}}@media (max-width:380px){#u,#v{display:none}.done #u,.done #v{display:inherit}#g.done a div.cost{padding-left:.5rem;margin-right:.5rem}}
    </style>

	<script src="https://cdn.bootcdn.net/ajax/libs/popper.js/2.4.4/cjs/popper.min.js"></script>
	<script src="https://cdn.bootcdn.net/ajax/libs/tippy.js/6.2.6/tippy-bundle.umd.min.js"></script>
	<script src="bugsnag.min.js"></script>
	<script src="https://cdn.bootcdn.net/ajax/libs/howler/2.2.1/howler.min.js" integrity="sha512-L6Z/YtIPQ7eU3BProP34WGU5yIRk7tNHk7vaC2dB1Vy1atz6wl9mCkTPPZ2Rn1qPr+vY2mZ9odZLdGYuaBk7dQ==" crossorigin="anonymous"></script>
	<script>
		try {
			Bugsnag.start({ apiKey: '5115978421858820764236d7180c2e93' });
        } catch (e) {
            console.log("No Bugsnag :(");
        }
	</script>
	<title>灵魂回响 - Soul Not Found</title>
</head>

<body>
<script src="chs.js?07071443"></script>
<script src="https://cdn.jsdelivr.net/gh/g8hh/g8hh.github.io/zh/core.js"></script>
	<div id="yy">
		<div id="xx" class="p">
			<div id="y">
				<div id="ww">
					<span id="a"></span>
					<span id="b"></span>
				</div>
			</div>
			<div class="c" id="d">
				<span>lvl 10</span>
			</div>
			<button id="e">
				<strong>Reset</strong>
				<span class="info">Become Stronger!</span>
			</button>
			<div id="r">
				<div id="vv">
					<span id="s"></span>
					<span id="f"></span>
				</div>
			</div>
		</div>
		<div class="oo" id="battle">
			<a href="#" id="l">
				<div id="m">
					<svg viewBox="0 0 64 64"><path d="M50 21c0-10-8-19-18-19s-18 8-18 19v9h6v-9c0-7 5-12 12-12s12 5 12 12zM11 32c-2 3-3 6-3 10 0 11 11 20 24 20s24-9 24-20c0-4-1-7-3-10zm21 3c3 0 5 2 5 5 0 2-1 4-3 5l4 12H26l4-12a5 5 0 012-10z"/></svg>
				</div>
				<div id="uu"></div>
				<div id="tt"></div>
			</a>
			<div id="ss" class="p">
				<div id="stage">
					<span id="rr"></span>
					<div class="color-soul-notifications">
						<div class="start-soul-notification">Gained <strong class="souls-gained-notification">X</strong> <span class="soul-name-count-change">souls</span>!</div>
					</div>
				</div>
				<div id="enemy"></div>
				<div id="h"></div>
			</div>
			<button class="p" id="zz"></button>
			<a href="#" id="unitInfo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm1.25 17c0 .69-.559 1.25-1.25 1.25-.689 0-1.25-.56-1.25-1.25s.561-1.25 1.25-1.25c.691 0 1.25.56 1.25 1.25zm1.393-9.998c-.608-.616-1.515-.955-2.551-.955-2.18 0-3.59 1.55-3.59 3.95h2.011c0-1.486.829-2.013 1.538-2.013.634 0 1.307.421 1.364 1.226.062.847-.39 1.277-.962 1.821-1.412 1.343-1.438 1.993-1.432 3.468h2.005c-.013-.664.03-1.203.935-2.178.677-.73 1.519-1.638 1.536-3.022.011-.924-.284-1.719-.854-2.297z"/></svg></a>
		</div>
		<div class="oo" id="skills">
			<div class="p">
				<div id="q">
					<span id="qq"></span>
					<div id="t">
						<button class="p" id="w">
							<span>Attack</span>
							<strong id="u">0</strong>
							<svg viewBox="0 0 24 24"><path d="M24 10h-10v-10h-4v10h-10v4h10v10h4v-10h10z"/></svg>
						</button>
						<button class="p" id="x">
							<span>Defense</span>
							<strong id="v">0</strong>
							<svg viewBox="0 0 24 24"><path d="M24 10h-10v-10h-4v10h-10v4h10v10h4v-10h10z"/></svg>
						</button>
					</div>
				</div>
				<span id="pp">Skills</span>
				<div id="g" class="lock">
					<div class='c'>
						<span>lvl 6</span>
					</div>
				</div>
				<div>
					<a href="#" class="o" data-id="1">x1</a>
					<a href="#" class="o" data-id="10">x10</a>
					<a href="#" class="o" data-id="50">x50</a>
					<a href="#" class="o" data-id="99999999">MAX</a>
				</div>
				<a href="#" id="statInfo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm1.25 17c0 .69-.559 1.25-1.25 1.25-.689 0-1.25-.56-1.25-1.25s.561-1.25 1.25-1.25c.691 0 1.25.56 1.25 1.25zm1.393-9.998c-.608-.616-1.515-.955-2.551-.955-2.18 0-3.59 1.55-3.59 3.95h2.011c0-1.486.829-2.013 1.538-2.013.634 0 1.307.421 1.364 1.226.062.847-.39 1.277-.962 1.821-1.412 1.343-1.438 1.993-1.432 3.468h2.005c-.013-.664.03-1.203.935-2.178.677-.73 1.519-1.638 1.536-3.022.011-.924-.284-1.719-.854-2.297z"/></svg></a>
			</div>
		</div>
		<div class="oo" id="morality">
			<div class="p">
				<h1 style="margin-bottom: 0.75rem;">Morality</h1>
				<p style="font-size: .8rem; margin-bottom: 1.5rem; margin-top: 0; color: #aaa;">Infuse souls and make your army stronger!</p>
				<div class="color-souls">
					<div class="color-soul" data-id="0">
						<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="fill: #d64242; filter: drop-shadow(0px 0px 10px #000);"><defs/><path d="M261 18c-41 189-161 189-161 322 0 89 82 153 161 153 81 0 158-64 158-147 0-127-116-139-158-328zm-96 207c20 28 49 50 85 67-53 34-105 4-85-67zm186 0c20 71-32 101-85 67 36-17 65-39 85-67zm-228 91c13 15 32 29 53 39 1 19 7 34 24 53-1-16 0-31 3-43a207 207 0 00111 1c3 12 4 26 3 42 16-19 23-33 24-52 23-10 42-24 56-40-2 57-41 105-94 122l-11-34-13 39a143 143 0 01-38 0l-13-39-11 34c-53-17-92-65-94-122z"/></svg>
						<span id="red-soul-count">0</span>
					</div>
					<div class="color-soul" data-id="1">
						<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="fill: #48b138; filter: drop-shadow(0px 0px 10px #000);"><defs/><path d="M261 18c-41 189-161 189-161 322 0 89 82 153 161 153 81 0 158-64 158-147 0-127-116-139-158-328zm-96 207c20 28 49 50 85 67-53 34-105 4-85-67zm186 0c20 71-32 101-85 67 36-17 65-39 85-67zm-228 91c13 15 32 29 53 39 1 19 7 34 24 53-1-16 0-31 3-43a207 207 0 00111 1c3 12 4 26 3 42 16-19 23-33 24-52 23-10 42-24 56-40-2 57-41 105-94 122l-11-34-13 39a143 143 0 01-38 0l-13-39-11 34c-53-17-92-65-94-122z"/></svg>
						<span id="green-soul-count">0</span>
					</div>
					<div class="color-soul" data-id="2">
						<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="fill: #5373d8; filter: drop-shadow(0px 0px 10px #000);"><defs/><path d="M261 18c-41 189-161 189-161 322 0 89 82 153 161 153 81 0 158-64 158-147 0-127-116-139-158-328zm-96 207c20 28 49 50 85 67-53 34-105 4-85-67zm186 0c20 71-32 101-85 67 36-17 65-39 85-67zm-228 91c13 15 32 29 53 39 1 19 7 34 24 53-1-16 0-31 3-43a207 207 0 00111 1c3 12 4 26 3 42 16-19 23-33 24-52 23-10 42-24 56-40-2 57-41 105-94 122l-11-34-13 39a143 143 0 01-38 0l-13-39-11 34c-53-17-92-65-94-122z"/></svg>
						<span id="blue-soul-count">0</span>
					</div>
				</div>
				<div id="player-unit-to-uprade">

				</div>
				<div id="clear-colors">
					<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><defs/><path fill="#fff" d="M199 103v50h-78v30h270v-30h-78v-50H199zm18 18h78v32h-78v-32zm-79 80l30 286h176l30-286H138zm62 13l1 9 16 224 1 9-18 2-1-9-16-224-1-9 18-2zm112 0l18 2-1 9-16 224-1 9-18-2 1-9 16-224 1-9zm-65 1h18v242h-18V215z"/></svg>
				</div>
				<div id="select-unit-to-upgrade">

				</div>
				<a href="#" id="moralityInfo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm1.25 17c0 .69-.559 1.25-1.25 1.25-.689 0-1.25-.56-1.25-1.25s.561-1.25 1.25-1.25c.691 0 1.25.56 1.25 1.25zm1.393-9.998c-.608-.616-1.515-.955-2.551-.955-2.18 0-3.59 1.55-3.59 3.95h2.011c0-1.486.829-2.013 1.538-2.013.634 0 1.307.421 1.364 1.226.062.847-.39 1.277-.962 1.821-1.412 1.343-1.438 1.993-1.432 3.468h2.005c-.013-.664.03-1.203.935-2.178.677-.73 1.519-1.638 1.536-3.022.011-.924-.284-1.719-.854-2.297z"/></svg></a>

				<div>
					<a href="#" class="o" data-id="1">x1</a>
					<a href="#" class="o" data-id="10">x10</a>
					<a href="#" class="o" data-id="50">x50</a>
					<a href="#" class="o" data-id="99999999">MAX</a>
				</div>
			</div>
		</div>
		<div class="oo" id="nn">
			<div id="trophy-tabs">
				<a href="#" id="t1-tab">Tier 1</a>
				<a href="#" id="t2-tab" class="tier-locked"><svg viewBox="0 0 64 64"><path d="M32 2c-10 0-18 8-18 19v9h6v-9a12 12 0 1124 0v9h6v-9c0-10-8-19-18-19zM11 32l-3 9c0 12 10 21 24 21 13 0 24-9 24-21l-3-9zm21 3c3 0 5 2 5 5 0 2-1 4-3 5l4 12H26l4-12a5 5 0 012-10z" /></svg> Tier 2</a>
				<a href="#" id="t3-tab" class="tier-locked"><svg viewBox="0 0 64 64"><path d="M32 2c-10 0-18 8-18 19v9h6v-9a12 12 0 1124 0v9h6v-9c0-10-8-19-18-19zM11 32l-3 9c0 12 10 21 24 21 13 0 24-9 24-21l-3-9zm21 3c3 0 5 2 5 5 0 2-1 4-3 5l4 12H26l4-12a5 5 0 012-10z" /></svg> Tier 3</a>
			</div>
			<div class="p">
				<h1 id="mm"></h1>
				<p id="ll">Global <strong id="kk"></strong> Bonus</p>
				<ul id="j"></ul>
				<a href="#" id="trophyInfo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm1.25 17c0 .69-.559 1.25-1.25 1.25-.689 0-1.25-.56-1.25-1.25s.561-1.25 1.25-1.25c.691 0 1.25.56 1.25 1.25zm1.393-9.998c-.608-.616-1.515-.955-2.551-.955-2.18 0-3.59 1.55-3.59 3.95h2.011c0-1.486.829-2.013 1.538-2.013.634 0 1.307.421 1.364 1.226.062.847-.39 1.277-.962 1.821-1.412 1.343-1.438 1.993-1.432 3.468h2.005c-.013-.664.03-1.203.935-2.178.677-.73 1.519-1.638 1.536-3.022.011-.924-.284-1.719-.854-2.297z"/></svg></a>
			</div>
		</div>
		<div class="oo" id="info-content">
			<div id="info-tabs">
				<a href="#" id="info-tab">Info</a>
				<a href="#" id="export">Save</a>
				<a href="#" id="import">Load</a>
				<a href="#" id="hard-reset">Hard Reset</a>
				<a href="#" id="sound" style="padding: 0; display: flex; justify-content: center; align-items: center;">
					<svg style="fill: #ccc; display: none" id="sound-is-on" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M5 17h-5v-10h5v10zm2-10v10l9 5v-20l-9 5zm17 4h-5v2h5v-2zm-1.584-6.232l-4.332 2.5 1 1.732 4.332-2.5-1-1.732zm1 12.732l-4.332-2.5-1 1.732 4.332 2.5 1-1.732z"/></svg>
					<svg style="fill: #ccc;" id="sound-is-off" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M22 1.269l-18.455 22.731-1.545-1.269 3.841-4.731h-1.827v-10h4.986v6.091l2.014-2.463v-3.628l5.365-2.981 4.076-5.019 1.545 1.269zm-10.986 15.926v.805l8.986 5v-16.873l-8.986 11.068z"/></svg>
				</a>
			</div>
			<div class="p" id="info-tab-info-tab-content">
				<h1>Spirit Dungeons</h1>
				<p>I'm working on a full version of the game with unique Units, Skills, Mechanics, and so much MORE!</p>
				<p>If you like the game so far then consider <a href="https://spiritdungeons.com/waitlist/?ref=soul-not-found">joining the waitlist</a> to be one of the first to play full version of <strong>Spirit Dungeons</strong> formerly know as <i>Soul Not Found</i></p>
				<p>Otherwise...</p>
				<ul>
					<li>Join my <a href="https://discord.gg/HBqCfc9" target="_blank">Discord</a></li>
					<li><a href="https://martintale.com/about-me?ref=soul-not-found#message-me" target="_blank">Message Me</a> directly</li>
					<li>or <a href="https://ko-fi.com/martintale?ref=soul-not-found" target="_blank">Buy me a Coffee</a>!</li>
				</ul>
				<p>Thanks for playing, <br><a href="https://martintale.com/?ref=soul-not-found" target="_blank">Martin Tale</a></p>
				<hr style="margin: 3rem 0 2rem 0">
				<h1>Credits</h1>
				<p>Icons by <a href="http://lorcblog.blogspot.com/?ref=soul-not-found" target="_blank">Lorc</a>, <a href="http://delapouite.com/?ref=soul-not-found" target="_blank">Delapouite</a> and <a href="https://opengameart.org/content/95-game-icons?ref=soul-not-found" target="_blank">sbed</a> under <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">CC BY 3.0</a>;</p>
				<p>Music and Sound by <a href="https://www.cade-conkle.com/?ref=soul-not-found" target="_blank">Cade Conkle</a></p>
				<p>Thanks to <a href="https://discord.gg/VYehZ37hYT" target="_blank">Decade Jam</a> and <a href="https://discord.gg/HBqCfc9" target="_blank">my Discord community</a> for helping me playtest the game;</p>
				<p>Thanks to Florent Cailhol and Randy Tayler for helping me compress the game to 13 kilobytes for the <a href="https://js13kgames.com/?ref=soul-not-found" target="_blank">js13kGames jam</a>!</p>
			</div>
			<div class="p" id="info-tab-export-content">
				<p>Copy the content of text field to export (save it in your notes/text file/etc)</p>
				<textarea id="current-save" readonly></textarea>
				<a href="#" id="copy-save">Copy</a>
			</div>
			<div class="p" id="info-tab-import-content">
				<p>Paste and load existing save file content. </p>
				<p style="color: #a03536">This action is not reversable and will override your current game progress!</p>
				<textarea id="new-save"></textarea>
				<a href="#" id="load-game">Load Game</a>
			</div>
			<div class="p" id="info-tab-hard-reset-content">
				<p>This will reset all your progress and you will have to start the game over from <strong>zero</strong></p>
				<p style="color: #a03536">This action is not reversable and will override your current game progress!</p>
				<a href="#" id="hard-reset-game">Reset Game</a>
			</div>
		</div>
		<div class="p" id="nav">
			<a href="#" id="z" class="k n">
				<span>Battle</span>
			</a>
			<a href="#" id="aa">
				<span>Skills</span>
				<div class='c'>
					<span>lvl 2</span>
				</div>
				<div class="ee"></div>
			</a>
			<a href="#" id="gg">
				<span>Morality</span>
				<div class='c'>
					<span>lvl 30</span>
				</div>
				<div class="ee"></div>
			</a>
			<a href="#" id="ff" class="k">
				<span>Trophies</span>
				<div class="ee"></div>
			</a>
			<a href="#" id="info" class="k">
				<span>Info</span>
			</a>
		</div>
		<div id="jj" class="p">
			<p id="ii"></p>
			<button id="hh">OK</button>
		</div>
		<div id="bigPopUp" class="p">
			<p id="bigPopUpContent"></p>
			<button id="bigPopUpClose">OK</button>
		</div>
		<div id="popUpConfirmation" class="p">
			<p id="popUpConfirmationContent"></p>
			<div>
				<button id="popUpConfirmationClose">Cancel</button>
				<button id="popUpConfirmationContinue">OK</button>
			</div>
		</div>
	</div>
	<script>
        function addEvent(e,t,a){e.addEventListener(t,a)}const monetization=document.monetization,click="click",afterbegin="afterbegin",m=Math,svg=(e,t=64)=>`<svg viewBox="0 0 ${t} ${t}"><path d="${e}"/></svg>`,increase="Increases your ";let openTrophyTier=1,vampireBonus=0;const backgroundMusic=new window.Howl({src:["audio/background-music.ogg"],volume:0,loop:!0}),startFightSound=new window.Howl({src:["audio/Start_Fight.ogg"]}),chooseNewSkillSound=new window.Howl({src:["audio/Choose_New_Skill.ogg"],volume:.5}),changeTabSound=[new window.Howl({src:["audio/Change_Tab_0.ogg"]}),new window.Howl({src:["audio/Change_Tab_1.ogg"]}),new window.Howl({src:["audio/Change_Tab_2.ogg"]}),new window.Howl({src:["audio/Change_Tab_3.ogg"]}),new window.Howl({src:["audio/Change_Tab_4.ogg"]})],monsterGruntSound=[new window.Howl({src:["audio/Monster_Grunt_0.ogg"]}),new window.Howl({src:["audio/Monster_Grunt_1.ogg"]}),new window.Howl({src:["audio/Monster_Grunt_2.ogg"]}),new window.Howl({src:["audio/Monster_Grunt_3.ogg"]}),new window.Howl({src:["audio/Monster_Grunt_4.ogg"]}),new window.Howl({src:["audio/Monster_Grunt_5.ogg"]})],buyBigSound=[new window.Howl({src:["audio/Buy_Big_0.ogg"]}),new window.Howl({src:["audio/Buy_Big_1.ogg"]}),new window.Howl({src:["audio/Buy_Big_2.ogg"]}),new window.Howl({src:["audio/Buy_Big_3.ogg"]}),new window.Howl({src:["audio/Buy_Big_4.ogg"]})],buySmallSound=[new window.Howl({src:["audio/Buy_Small_0.ogg"]}),new window.Howl({src:["audio/Buy_Small_1.ogg"]}),new window.Howl({src:["audio/Buy_Small_2.ogg"]}),new window.Howl({src:["audio/Buy_Small_3.ogg"]}),new window.Howl({src:["audio/Buy_Small_4.ogg"]})];function convertMS(e){let t,a,l;e=Date.now()-e,l=Math.floor(e/1e3),a=Math.floor(l/60),l%=60,t=Math.floor(a/60),a%=60;const n=Math.floor(t/24);return t%=24,`${n} days, ${t} hours, ${a} minutes and ${l} seconds`}const getElemById=e=>document.getElementById(e),getElemBySelector=(e,t=document)=>t.querySelectorAll(e),setStyle=(e,t,a)=>{e.style[t]=a},getLength=e=>e.length,insertHtml=(e,t,a)=>{e.insertAdjacentHTML(t,a)};class Tween{constructor(e,t,a){this.target=e,this.handler=t,this.start=a.start,this.end=a.end,this.easing=a.easing,this.from=a.from,this.to=a.to,this.keys=[],this.onstart=a.onstart,this.onprogress=a.onprogress,this.onend=a.onend,this.running=!1,this.store=e.__liike||(e.__liike={})}init(){for(const e in this.to)e in this.from||(this.from[e]=this.store[e]||0),this.keys.push(e);for(const e in this.from)e in this.to||(this.to[e]=this.store[e]||0,this.keys.push(e))}tick(e){const t=this.easing(e);for(let e=0;e<getLength(this.keys);e++){const a=this.keys[e];this.store[a]=this.from[a]+(this.to[a]-this.from[a])*t}this.handler(this.target,this.store)}}const easeInBy=e=>t=>m.pow(t,e),easeOutBy=e=>t=>1-m.abs(m.pow(t-1,e)),quadOut=easeOutBy(2),quartIn=easeInBy(4),quintOut=easeOutBy(5),ease=[quadOut,quartIn,quintOut],tweens=[],jobs=[],nullFunc=()=>{};let ticking=0;const tick=e=>{for(;getLength(jobs);){jobs.shift()(e)}for(let t=0;t<getLength(tweens);t++){const a=tweens[t];if(e<a.start)continue;a.running||(a.running=!0,a.init(),a.onstart(a.target));const l=(e-a.start)/(a.end-a.start);a.tick(l<1?l:1),a.onprogress(a.target,l),e>a.end&&(a.onend(a.target),tweens.splice(t--,1))}ticking=getLength(jobs)||getLength(tweens)?requestAnimationFrame(tick):0},liike=e=>function(t,a){const{delay:l=0}=a,{duration:n=0}=a,{from:o={}}=a,{to:s={}}=a,{easing:r=0}=a,{onprogress:i=nullFunc}=a,{onstart:g=nullFunc}=a,{onend:m=nullFunc}=a;jobs.push(a=>{const p=new Tween(t,e,{start:a+l,end:a+l+n,from:o,to:s,easing:ease[r],onstart:g,onprogress:i,onend:m});tweens.push(p)}),ticking||(ticking=requestAnimationFrame(tick))},transform=(e,t)=>{const{x:a=0,y:l=0,rotation:n=0,opacity:o=1}=t;setStyle(e,"transform",`translate(${a}px, ${l}px) rotate(${n}deg)`),setStyle(e,"opacity",o)},tween=liike(transform);let gameState,player,enemy,navElements,lastRender=0,inBattle=!0,unitToRestoreGeneration=null,nextSaveAt=3e4;const tabContent=[];let playerCurrentLevelElement,playerNextLevelProgressElement,playerCurrentGoldElement,playerGoldPerSecondElement,stageCurrentElement,battleBlockElement,attackElement,attackAttributeValueElement,defenseAttributeValueElement,attributeBlockElement,navSkillsElement,navMoralityElement,navTrophiesElement,navInfoElement,trophyTitleElement,trophyListElement,lastTrophyNotification,lastMoralityNotification,skillTitleElement,skillLockElement,playerUnitTimeProgressElements=[],playerUnitAmountElements=[],playerUnitElements=[],firstGameLockDone=!1,goldAmountsToCheck=[],lostGoldAmountsToCheck=[],processingAttackAction=0;const unitUnlockLevel=[0,10,22,36,50,70],uiIcons={gold:svg("M24 2h-1c-1 0-2 0-3 2h-1l-4-1-3 2v1h-1L8 5 6 7l8 6h4c2-1 4-1 5-3l3-7a4 4 0 00-2-1zm1 9a13 13 0 01-8 4l-1 2c0 2 1 4 3 5l-2 1-2-3 2 7-2 1c-2-5-2-9 0-13h-2l-1 1c-3 3-5 8-4 11l3 6a14 15 0 014 0h3l6 1 2 2a3 3 0 011-2l-2-3 3-3v-2c-1 0-2-1-2-3l1-2a3 3 0 01-1-3l-1-3 1-3-1-1zm10 1l-6 1-2 2 2 3 6 1h3v-2l3-1v2l3-3-3-2-6-1zm9 6l-1 1v3l2-3-1-1zm-16 1l2 3 6 1h5v-3l-6 1-7-2zm0 4l2 3 6 1h4v-2a18 19 0 01-11-2zm17 0a9 9 0 01-2 1v2l2-3zm0 3v4l1-2-1-2zm-16 1v1l3 2a16 16 0 0010 1v-3l-6 1-7-1zm-1 2l-1 2 2 3 6 1h3v-2l-7-1-3-3zm15 3l-2 1v1l2-2zm1 2l-1 1v3l2-3-1-1zm-32 0a14 14 0 00-9 3l-1 3 2 2h6l2-1v-2l3-2v2c1-1 2-2 1-3l-2-1-2-1zm6 1v3a11 11 0 014 1h2v2l2-3-2-2-6-1zm10 0l2 3 6 1h4v-3a18 18 0 01-12-1zm0 4v1l2 2 6 1h4v-2a18 19 0 01-11-2zm17 0a9 9 0 01-2 1v2l2-2zm-28 0l-1 1a17 17 0 01-8 4l1 1 6 1h2v-2l3-1v2l2-2-2-3-3-1z",48),book:svg("M7 5v31l10 4v-3l-8-4 2-1 6 2-3-27-7-2zm50 0c-8 3-18 0-24 9v26c2-3 6-5 9-5 4-1 8-1 11-4l2 2c-4 3-9 3-13 4-3 1-7 2-9 8l24-9zM16 6l3 29v27l3-5 3 5V37L21 7zm8 3l3 27a11 11 0 014 4V14l-7-5zM3 9v31l14 5v-3L5 38V9zm56 0v29L32 48l-5-2v5c3 1 7 0 11-1v-2l23-8V9zM27 39v4l3 2-3-6z"),level:svg("M12 2v19l1 1 15 3 6-8 6 8a68 62 0 0016-4l1-19-11 12-5-12-7 13-7-13-5 12zm22 19l-4 5 4 5 4-5zm-23 3h-1c0 1 0 2 3 3l17 3-2-3a57 51 0 01-17-3zm46 0h-1l-15 3-3 3c6 0 11-1 17-3l3-3h-1zm-3 5l-17 4-3 2-2-2-18-3c-2 3-3 7-3 11 5 2 9 5 11 8 1 3 2 7 1 10l3 1 1-6h3l-1 7h4v-7h3v7h4l-1-7h2l1 6 3-2c0-3 0-6 2-9s5-5 10-8l-3-12zm-36 6c4 0 9 2 14 5-7 4-18 4-15-5zm33 0h1c3 9-8 9-15 5 5-3 9-5 14-5zm-17 7l4 8h-7c0-3 2-6 3-8z"),battle:svg("M8 2a2 2 0 00-1 1 2 2 0 002 4l7 8-6 5 3 4 4-7 1 5 10-2-3-3-5-2 7-4-3-3-6 5-8-8a2 2 0 00-2-3zm48 0a2 2 0 00-2 3l-7 8-6-5-3 3 7 4-5 2-3 3 10 1v-4l5 7 3-4-6-5 7-8a2 2 0 100-5zM33 22l-15 2c0 11 4 26 15 33 10-7 15-22 15-33l-15-2zM18 41L8 53l-2 8 8-2 8-10-4-8zm29 1l-4 8 8 9 8 2-2-8z"),morality:svg("M32 3a29 29 0 100 58 29 29 0 000-58zm-1 2c-15 1-15 27 1 27s16 26 1 27h-1a27 27 0 01-1-54zm1 8c3 0 5 2 5 5s-2 5-5 5-5-2-5-5 2-5 5-5zm0 28c-3 0-5 2-5 5s2 5 5 5 5-2 5-5-2-5-5-5z"),trophy:svg("M32 3L17 4l-4 1h-2l-1 2v4H7V8L4 7C3 20 8 33 18 42l1-3-1-2 2-2 6 4c3 2 1 4-3 5 7 1 5 7-2 11h-1l-3 1-2 1v2l2 1 3 1a86 86 0 0027-1l1-1 1-1-1-1-1-1-3-1h-1c-7-4-9-10-2-11-4-1-6-3-3-5l6-4 2 2-2 2 2 3c10-9 15-22 14-35l-3 1v3h-3V7l-1-2h-2l-4-1-15-1zm0 2a99 99 0 0118 2h1-1a98 98 0 01-36 0h-1 1a98 98 0 0118-2zM7 14h4c1 7 3 14 7 18l-3 3c-4-6-7-14-8-21zm46 0h4c-1 7-4 14-9 20l-2-2c4-4 6-11 7-18z"),info:svg("M453 17c0 7 2 16 6 23 5 7 11 13 18 15 9-11-6-38-21-38h-3zm-111 8l-13 25 62 100 25-2 14-22-9-15-28 17-38-63-4-7 27-17-9-15zm94 2l-60 37 23 39 61-37a60 60 0 01-24-39zM311 47l-162 2c10 24 8 48-4 66-19-14-45-15-64-18-14 124-6 226-6 343 0 9-1 23 5 32 2 4 4 6 8 9 18-6 41-13 55-22h-21c-9 0-19-6-25-19-3-7-7-18 0-29 3-5 9-10 14-10h280c-6-77-10-154-6-233l-4 1-15-25-67 41 7 11-15 9-59-92 15-10 8 13 68-42-11-19-3-5zm-180 4c-16 8-30 18-41 29 16 1 33 3 48 10 3-14-3-27-7-39zm202 39l-67 40 7 12 34-20 9 15-33 21 7 12 67-41zm-132 46l1 18-90 2v-18a35164 35164 0 0089-2zm145 79l1 18-235 3v-18zm0 41l1 18-124 3v-18zm-235 3h91v18h-91zm235 33v18l-62 2v-18zm-84 2l1 18-151 3v-18zm86 53l1 18-126 2v-18zm-196 70c10 10 18 22 15 37-2 11-10 18-20 23l-32 14a1396 1396 0 01-12 4l301-7c8-1 15-6 20-14s7-18 7-23c-1-6-5-15-11-22-7-6-14-10-19-10h-1zm-40 3c-1 2 0 9 2 13 3 9 6 8 8 8 9 3 17 1 26-1-2-4-6-8-11-12-4-2-20-15-25-8z",512),soul:svg("M261 18c-41 189-161 189-161 322 0 89 82 153 161 153 81 0 158-64 158-147 0-127-116-139-158-328zm-96 207c20 28 49 50 85 67-53 34-105 4-85-67zm186 0c20 71-32 101-85 67 36-17 65-39 85-67zm-228 91c13 15 32 29 53 39 1 19 7 34 24 53-1-16 0-31 3-43a207 207 0 00111 1c3 12 4 26 3 42 16-19 23-33 24-52 23-10 42-24 56-40-2 57-41 105-94 122l-11-34-13 39a143 143 0 01-38 0l-13-39-11 34c-53-17-92-65-94-122z",512)},premiumIcons={gold:"💰",book:"📚",level:"🤴",battle:"⚔️",morality:"😇",trophy:"🏆",info:"ℹ️",soul:"👻"},trophyColors=["#ffffff","#619663","#4d84b9","#8c458c","#ce9938","#ff6280"],units=[[svg("M64 4C34 4 4 19 4 42c0 15 11 22 11 37 0 11-4 11-4 19 0 4 12 8 23 11v15h60v-15s23-7 22-11c0-7-3-8-3-19 0-7 11-23 11-37 0-23-30-38-60-38zM41 49a15 15 0 110 30 15 15 0 010-30zm45 0a15 15 0 110 30 15 15 0 010-30zM64 75c4 0 11 15 11 19 0 8 0 8-4 8H56c-3 0-3 0-3-8 0-4 7-19 11-19z",128),"💀",1020,5,4,1,3,6,4,.01,"Skeleton","Generates quickly!"],[svg("M32 3l-5 1c6 3 13 6 22 8l-3-3c-4-3-9-6-14-6zm-9 2l-7 5 4 1a326 326 0 0024 6h7v-2C40 13 31 9 23 5zm-8 7l-1 3-2 4 23-2h-4a338 338 0 01-16-5zm37 7l-42 3v3c15-2 29-1 43 0v-3l-1-3zm-35 7l5 6c2 1 5-1 7-2-4 0-8-2-12-4zm30 0c-4 2-8 4-11 4 1 1 4 3 6 2l5-6zm4 1l-2 6h2l2-6zm-38 0l-2 1v2l3 1zm-4 3l-4 9 4 1 2-3-1-2zm3 3l2 6c11 3 24 3 36 3l1-7c-13 1-26 1-39-2zm3 9l2 7c14-3 26-3 32-3v-2c-11 0-23 0-34-2zm22 7h-3l1 2zm8 0l-2 4h2l2-4zm4 0l-2 5 4 6 3-5a16 16 0 01-5-6zm-19 0h-2l1 3zm-10 1l-2 1 1 2h2zm6 1l-1 3h2zm6 0v3h2zm6 1l-1 2h2zm-18 3l1 3 7 3 7-5-15-1zm24 0l-6 1-7 5h1c5 0 9-1 11-3z"),"🧟",1700,5,5,2,3,15,3,.02,"Zombie","Taunts enemies!"],[svg("M34 2h-1c-6 1-11 6-10 10 0 3 2 6 5 7l1 1 2 2 9-1 1-3c3-2 4-5 4-8 0-4-5-8-11-8zm6 6a3 3 0 110 6 3 3 0 010-6zm-11 2a3 3 0 110 6 3 3 0 010-6zm5 4l3 5h-5zm-20 1c-7 0-8 2-11 3 0 8 4 16 2 29 2-1 7-12 7-12l-1 11 7-12v6l4-6c0 3-1 7-3 9-5 7-6 17-6 17l5-7-2 9c5-4 7-8 8-13l1 13 3-8 5 8v-9c1 3 7 6 10 5-5-5-8-20 2-25l-3 8c4-1 6-4 7-6l-1 14 6-14v13c7-6 7-13 7-27-4-3-9-5-15-6l-3 5-1 3h-1l1 4h-3v-3h-2v4h-2l-1-4h-2v4h-2l-1-4-2-3a12 12 0 01-6-5l-7-1z"),"👻",3400,7,7,3,5,18,5,.04,"Wight","Generates experience!"],[svg("M24 2c-4 0-10 0-13 3l-2 9v3l1 1 1-2a39 39 0 010-2v-2h1v-1h-1V9h2V8h-1l1-2c3-3 6-3 10-3l1 4 1-4c4 0 8 1 10 3l1 2h-2v1h3v2h-1v1h1v2a39 39 0 010 2l1 2 1-1v-3l-2-9c-4-3-9-3-13-3zm-9 12c-3 1-4 5-4 10v4c1 3 3 4 5 6v8l1 1 7 2c3 0 5 0 7-2l1-1v-8c2-2 5-3 5-6v-4c0-5-1-9-4-10h-4l-5 2-5-2h-4zM5 17l2 8 2 3 1 1v-5-4l-2-2-3-1zm38 0l-3 1-2 2v9l1-1 2-3 2-8zm-27 2l7 7-1 1v1h-9c0-1 2-4 5-4l-2-2-2 2-1-1zm2 9a1 1 0 100-3 1 1 0 000 3zm13-9l4 4-1 1-3-2-1 2c3 0 4 3 4 4h-9l1-1-1-1zm-1 9a1 1 0 100-3 1 1 0 000 3zm-19 3l-9 5c4 1 7 3 9 5l2 5h7l-5-2-1-2v-8l-3-3zm26 0l-3 3v8l-1 2-5 2h7l2-5c2-2 5-4 9-5l-9-5zm-15 1l2 1 2-1 2 1-4 2-4-2zm-3 5l1 1h8l1-1 2 1-2 1h-1l-1 4-1-4h-4l-1 4-1-4h-1l-2-1z",48),"🧛",6120,10,9,5,8,30,6,.08,"Vampire","Gets stronger the more they stay in battle! (resets at the end of the battle)"],[svg("M31 3c-8 0-16 2-21 5H9c3 7 6 12 10 16v9l8 4-6 24h24l-4-17 8 13 2-1c-2-6-6-10-9-14l4-3-6-13 6-5c-2-4-5-8-9-11-4 2-6 7-9 11l-4 5-9-12c9-6 24-8 37-5-5-5-13-6-21-6z"),"👽",20400,16,16,15,30,120,7,.3,"Grim Reaper","Generates skeletons!"],[svg("M25 5C5 10-2 38 5 54a51 51 0 0111-39c-3 12-3 24 1 32-2-10-1-22 2-30 0 7 1 14 4 19-1-13 6-5 8-1v5c0 2-2 4-4 5-4 2-7 5-7 8-1 2 0 5 2 7 1 1 4 2 7 1 2-1 4-3 5-6l3 2c0-4 1-7 3-10l-12 5 4 1c-1 4-3 5-4 6l-5-1c-1-1-2-3-1-5 0-2 2-4 6-6 3-1 5-3 6-6l-1-8c3-4 9-8 7 3 3-5 4-12 4-19 4 8 5 20 2 30 5-8 5-20 2-32 8 9 13 23 11 39 7-16-1-44-21-49 4 11 6 20-6 24-12-4-11-13-7-24zm2 7l-1 4c0 5 2 8 6 10a11 11 0 004-14s-2 7-4 9l-5-9z"),"🐲",30600,17,15,25,50,150,9,.5,"Bone Dragon","Can only be attacked by flying units! (Wights and Bone Dragons)"]],skillKey={wrath:0,calm:1,prosperity:2,learning:3,necromancy:4,skeleton:5,zombie:6,wight:7,vampire:8,grimReaper:9,boneDragon:10},skills=[["Wrath",increase+"Attack power",skillKey.wrath,.05,1e3,1.05],["Calm",increase+"Defense power",skillKey.calm,.025,1e3,1.05],["Prosperity",increase+"Gold gain",skillKey.prosperity,.05,1e3,1.05],["Learning",increase+"Experience gain",skillKey.learning,.025,1e3,1.1],["Necromancy",increase+"Production speed that scales with stage",skillKey.necromancy,.01,1e4,1.5],["Skeleton",increase+"Skeleton power & generation speed",skillKey.skeleton,.05,1e3,1.05],["Zombie",increase+"Zombie power & generation speed",skillKey.zombie,.05,1e3,1.05],["Wight",increase+"Wight power & generation speed",skillKey.wight,.05,1e3,1.05],["Vampire",increase+"Vampire power & generation speed",skillKey.vampire,.05,1e3,1.05],["Grim Reaper",increase+"Grim Reaper power & generation speed",skillKey.grimReaper,.05,1e3,1.05],["Bone Dragon",increase+"Bone Dragon power & generation speed",skillKey.boneDragon,.05,1e3,1.05]],trophyKey={skeleton:0,zombie:1,wight:2,vampire:3,grimReaper:4,boneDragon:5,gold:6,level:7,attack:8,defense:9,skillUpgrades:10,enemiesKilled:11,morality:12,stage:13,souls:14,soulsSkeleton:15,soulsZombie:16,soulsWight:17,soulsVampire:18,soulsGrimReaper:19,soulsBoneDragon:20,color:21,colorTwo:22,colorAll:23},trophies=[{type:trophyKey.skeleton,value:100},{type:trophyKey.skeleton,value:500},{type:trophyKey.skeleton,value:1e3},{type:trophyKey.skeleton,value:5e3,special:!0},{type:trophyKey.skeleton,value:1e4},{type:trophyKey.skeleton,value:25e3},{type:trophyKey.zombie,value:100},{type:trophyKey.zombie,value:500},{type:trophyKey.zombie,value:1e3},{type:trophyKey.zombie,value:4e3},{type:trophyKey.zombie,value:8e3,special:!0},{type:trophyKey.zombie,value:15e3},{type:trophyKey.wight,value:10},{type:trophyKey.wight,value:50},{type:trophyKey.wight,value:100},{type:trophyKey.wight,value:500},{type:trophyKey.wight,value:1e3},{type:trophyKey.wight,value:5e3,special:!0},{type:trophyKey.vampire,value:10},{type:trophyKey.vampire,value:50},{type:trophyKey.vampire,value:100},{type:trophyKey.vampire,value:500},{type:trophyKey.vampire,value:1e3},{type:trophyKey.vampire,value:5e3,special:!0},{type:trophyKey.grimReaper,value:10},{type:trophyKey.grimReaper,value:50},{type:trophyKey.grimReaper,value:100},{type:trophyKey.grimReaper,value:500},{type:trophyKey.grimReaper,value:1e3},{type:trophyKey.grimReaper,value:5e3,special:!0},{type:trophyKey.boneDragon,value:10},{type:trophyKey.boneDragon,value:50},{type:trophyKey.boneDragon,value:100},{type:trophyKey.boneDragon,value:500},{type:trophyKey.boneDragon,value:1e3},{type:trophyKey.boneDragon,value:2500,special:!0},{type:trophyKey.gold,value:1e4},{type:trophyKey.gold,value:1e5},{type:trophyKey.gold,value:1e6},{type:trophyKey.gold,value:1e9},{type:trophyKey.gold,value:1e12},{type:trophyKey.gold,value:1e16},{type:trophyKey.level,value:3},{type:trophyKey.level,value:6},{type:trophyKey.level,value:12},{type:trophyKey.level,value:20},{type:trophyKey.level,value:30},{type:trophyKey.level,value:50},{type:trophyKey.attack,value:3},{type:trophyKey.attack,value:6},{type:trophyKey.attack,value:10},{type:trophyKey.attack,value:16},{type:trophyKey.attack,value:22},{type:trophyKey.attack,value:30},{type:trophyKey.defense,value:3},{type:trophyKey.defense,value:6},{type:trophyKey.defense,value:10},{type:trophyKey.defense,value:16},{type:trophyKey.defense,value:22},{type:trophyKey.defense,value:30},{type:trophyKey.skillUpgrades,value:100},{type:trophyKey.skillUpgrades,value:250},{type:trophyKey.skillUpgrades,value:500},{type:trophyKey.skillUpgrades,value:1e3},{type:trophyKey.skillUpgrades,value:2500},{type:trophyKey.skillUpgrades,value:5e3},{type:trophyKey.enemiesKilled,value:100},{type:trophyKey.enemiesKilled,value:1e3},{type:trophyKey.enemiesKilled,value:5e3},{type:trophyKey.enemiesKilled,value:25e3},{type:trophyKey.enemiesKilled,value:1e5},{type:trophyKey.enemiesKilled,value:5e5},{type:trophyKey.stage,value:10},{type:trophyKey.stage,value:25},{type:trophyKey.stage,value:50},{type:trophyKey.stage,value:100},{type:trophyKey.stage,value:125},{type:trophyKey.stage,value:150},{type:trophyKey.morality,value:1}],trophiesTier2=[{type:trophyKey.souls,value:25},{type:trophyKey.souls,value:50},{type:trophyKey.souls,value:100},{type:trophyKey.souls,value:250},{type:trophyKey.souls,value:500},{type:trophyKey.souls,value:1e3},{type:trophyKey.soulsSkeleton,value:25},{type:trophyKey.soulsSkeleton,value:51,special:!0},{type:trophyKey.soulsSkeleton,value:100},{type:trophyKey.soulsZombie,value:25},{type:trophyKey.soulsZombie,value:51,special:!0},{type:trophyKey.soulsZombie,value:100},{type:trophyKey.soulsWight,value:25},{type:trophyKey.soulsWight,value:51,special:!0},{type:trophyKey.soulsWight,value:100},{type:trophyKey.soulsVampire,value:25},{type:trophyKey.soulsVampire,value:51,special:!0},{type:trophyKey.soulsVampire,value:100},{type:trophyKey.soulsGrimReaper,value:25},{type:trophyKey.soulsGrimReaper,value:51,special:!0},{type:trophyKey.soulsGrimReaper,value:100},{type:trophyKey.soulsBoneDragon,value:25},{type:trophyKey.soulsBoneDragon,value:51,special:!0},{type:trophyKey.soulsBoneDragon,value:100},{type:trophyKey.level,value:5e3},{type:trophyKey.level,value:1e4},{type:trophyKey.level,value:25e3},{type:trophyKey.level,value:5e4},{type:trophyKey.level,value:1e5},{type:trophyKey.level,value:25e4},{type:trophyKey.enemiesKilled,value:1e15},{type:trophyKey.enemiesKilled,value:1e16},{type:trophyKey.enemiesKilled,value:1e17},{type:trophyKey.enemiesKilled,value:1e18},{type:trophyKey.enemiesKilled,value:1e19},{type:trophyKey.enemiesKilled,value:1e20},{type:trophyKey.stage,value:200},{type:trophyKey.stage,value:250},{type:trophyKey.stage,value:300},{type:trophyKey.stage,value:325},{type:trophyKey.stage,value:350},{type:trophyKey.stage,value:375}],trophiesTier3=[{type:trophyKey.level,value:5e5},{type:trophyKey.level,value:1e6},{type:trophyKey.level,value:25e5},{type:trophyKey.level,value:5e6},{type:trophyKey.level,value:1e7},{type:trophyKey.level,value:25e6},{type:trophyKey.enemiesKilled,value:1e21},{type:trophyKey.enemiesKilled,value:1e22},{type:trophyKey.enemiesKilled,value:1e23},{type:trophyKey.enemiesKilled,value:1e24},{type:trophyKey.enemiesKilled,value:1e25},{type:trophyKey.enemiesKilled,value:1e26},{type:trophyKey.stage,value:400},{type:trophyKey.stage,value:425},{type:trophyKey.stage,value:450},{type:trophyKey.stage,value:470},{type:trophyKey.stage,value:490},{type:trophyKey.stage,value:500},{type:trophyKey.color,value:[51,0,0],name:"Red WTF",key:"red wtf"},{type:trophyKey.color,value:[0,51,0],name:"Green WTF",key:"green wtf"},{type:trophyKey.color,value:[0,0,51],name:"Blue WTF",key:"blue wtf"},{type:trophyKey.color,value:[26,25,0],name:"Wild Willow",key:"wild willow"},{type:trophyKey.color,value:[26,0,25],name:"Fuchsia Pink",key:"fuchsia pink"},{type:trophyKey.color,value:[0,26,25],name:"Fountain Blue",key:"fountain blue"},{type:trophyKey.color,value:[34,17,0],name:"Chelsea Gem",key:"chelsea gem"},{type:trophyKey.color,value:[34,0,17],name:"Deep Blush",key:"deep blush"},{type:trophyKey.color,value:[17,34,0],name:"Conifer",key:"conifer"},{type:trophyKey.color,value:[0,34,17],name:"Green Haze",key:"green haze"},{type:trophyKey.color,value:[17,0,34],name:"Purple",key:"purple"},{type:trophyKey.color,value:[0,17,34],name:"Endeavour",key:"endeavour"},{type:trophyKey.color,value:[40,6,5],name:"Thunderbird",key:"thunderbird"},{type:trophyKey.color,value:[6,40,5],name:"Screamin' Green",key:"screamin' green"},{type:trophyKey.color,value:[6,5,40],name:"Cornflower Blue",key:"cornflower blue"},{type:trophyKey.color,value:[17,17,17],name:"Silver Chalice",key:"silver chalice",secret:!0,special:!0},{type:trophyKey.colorTwo,value:[[40,6,5],[6,5,40]],name:"The Portal",key:"the portal",secret:!0,special:!0},{type:trophyKey.colorAll,value:[[51,0,0],[51,0,0],[51,0,0],[51,0,0],[51,0,0],[51,0,0]],name:"The Enemy",key:"the enemy",secret:!0,special:!0},{type:trophyKey.colorAll,value:[[17,17,17],[17,17,17],[17,17,17],[17,17,17],[17,17,17],[17,17,17]],name:"The Hound",key:"the hound",secret:!0,special:!0},{type:trophyKey.colorAll,value:[[51,0,0],[40,6,5],[26,25,0],[0,51,0],[0,0,51],[6,5,40]],name:"The Rainbow",key:"the rainbow",secret:!0,special:!0}],initialGameState=["0.1",Date.now(),Date.now(),Date.now(),1,16,0,0,0,0,[],[],[20],[units[0][7],units[1][7],units[2][7],units[3][7],units[4][7]],[0],[],[],0,-1,[],100,1.15,1.15,[],[0,0,0,0,0,0],0,0,0,0,0,0,0,0,!1,!1,1,0,0,1,[!1,!1,!1,!1,!1,!1],[],[]],abbreviatedNumberDictionary=["","k","m","b","t","Qa","Qi","Sx","Sp","Oc","No","Dc","Ud","Dd","Td","Qad","Qid","Sxd","Spd","Ocd","Nod","Vg","Uvg","Dvg","Tvg","Qavg","Qivg","Sxvg","Spvg","Ocvg","Novg","Tg","Utg","Dtg","Ttg","Qatg","Qitg","Sxtg","Sptg","Octg","Notg","Qag","Uqag","Dqag","Tqag","Qaqag","Qiqag","Sxqag","Spqag","Ocqag","Noqag","Qig","Uqig","Dqig","Tqig","Qaqig","Qiqig","Sxqig","Spqig","Ocqig","Noqig","Sxg","Usxg","Dsxg","Tsxg","Qasxg","Qisxg","Sxsxg","Spsxg","Ocsxg","Nosxg","Spg","Uspg","Dspg","Tspg","Qaspg","Qispg","Sxspg","Spspg","Ocspg","Nospg","Ocg","Uocg","Docg","Tocg","Qaocg","Qiocg","Sxocg","Spocg","Ococg","Noocg","Nog","Unog","Dnog","Tnog","Qanog","Qinog","Sxnog","Spnog","Ocnog","Nonog","C","Uc","Dc","Tc","Qac","Qic","Sxc","Spc","Occ","Noc"],getAbbreviatedNumberNotation=e=>{const t=m.floor(m.abs(e)/3);return abbreviatedNumberDictionary[t]},formatNumber=(e,t=!0)=>{let a="";return e<0&&(a="-"),(e=m.abs(e))<1e3?a+m.floor(e):t?a+(m.floor(e/m.pow(10,3*m.floor(m.abs(m.log10(e))/3))*10)/10).toFixed(1)+getAbbreviatedNumberNotation(m.floor(m.log10(e))):a+(m.ceil(e/m.pow(10,3*m.floor(m.abs(m.log10(e))/3))*10)/10).toFixed(1)+getAbbreviatedNumberNotation(m.floor(m.log10(e)))},getRandomArbitrary=(e,t)=>m.random()*(t-e)+e,getRandomInt=(e,t)=>(e=m.ceil(e),t=m.floor(t),m.floor(m.random()*(t-e+1))+e),openInfoTab=e=>{const t=document.getElementById("info-tab"),a=document.getElementById("export"),l=document.getElementById("import"),n=document.getElementById("hard-reset"),o=document.getElementById("info-tab-info-tab-content"),s=document.getElementById("info-tab-export-content"),r=document.getElementById("info-tab-import-content"),i=document.getElementById("info-tab-hard-reset-content");t.classList.toggle("active",!1),a.classList.toggle("active",!1),l.classList.toggle("active",!1),n.classList.toggle("active",!1),o.style.display="none",s.style.display="none",r.style.display="none",i.style.display="none","info-tab"==e?(t.classList.toggle("active",!0),o.style.display="block"):"export"==e?(a.classList.toggle("active",!0),s.style.display="block"):"import"==e?(l.classList.toggle("active",!0),r.style.display="block"):"hard-reset"==e&&(n.classList.toggle("active",!0),i.style.display="block"),gameState[52]&&changeTabSound[getRandomInt(0,4)].play()},orderBySpeed=(e,t)=>e[2]>t[2]?-1:e[2]<t[2]?1:0;let lockSaving=!1;const saveGame=e=>{if(lockSaving)return e;e[3]=Date.now();const t=JSON.stringify(e);return document.getElementById("current-save").value=window.btoa(t),localStorage.setItem("SNFGS2",t),e},saveLastRestart=e=>{localStorage.setItem("soulNotFoundLastRestart",JSON.stringify(e))},loadLastRestart=()=>{const e=localStorage.getItem("soulNotFoundLastRestart");return null==e?e:JSON.parse(e)},loadGame=(e=!1)=>{const t=localStorage.getItem("SNFGS2");return null==t||e?saveGame(JSON.parse(JSON.stringify(initialGameState.slice()))):JSON.parse(t)},openPopUp=e=>{getElemById("ii").innerHTML=e,setStyle(getElemById("jj"),"display","flex")},openBigPopUp=e=>{getElemById("bigPopUpContent").innerHTML=e,setStyle(getElemById("bigPopUp"),"display","flex")},openPopUpConfirm=(e,t="Cancel",a="OK",l=(()=>{}))=>{const n=getElemById("popUpConfirmationContinue");getElemById("popUpConfirmationContent").innerHTML=e,getElemById("popUpConfirmationClose").innerHTML=t,n.innerHTML=a,setStyle(getElemById("popUpConfirmation"),"display","flex"),n.onclick=null,n.onclick=()=>{gameState[52]&&chooseNewSkillSound.play(),l()}},closePopUp=()=>{setStyle(getElemById("jj"),"display","none"),setStyle(getElemById("bigPopUp"),"display","none"),setStyle(getElemById("popUpConfirmation"),"display","none")},getUnusedAttributes=()=>gameState[4]-1-gameState[6]-gameState[7],restartGame=()=>{gameState[4]<10||openPopUpConfirm("This will make things easier as you keep your attributes and trophy bonuses.<br><br>Do you want to restart now?","No","Yes",()=>{if(inBattle&&attack(),getUnusedAttributes()>0){const e=m.ceil(getUnusedAttributes()/2),t=m.floor(getUnusedAttributes()-e);gameState[6]+=e,gameState[27]+=e,gameState[7]+=t,gameState[28]+=t}const e=JSON.parse(JSON.stringify(initialGameState.slice()));e[36]=gameState[36]+gameState[6],e[37]=gameState[37]+gameState[7],e[24]=gameState[24],e[25]=gameState[25],e[26]=gameState[26],e[27]=gameState[27],e[28]=gameState[28],e[29]=gameState[29],e[30]=gameState[30],e[31]=gameState[31],e[32]=gameState[32],e[42]=gameState[42],e[43]=gameState[43],e[44]=gameState[44],e[45]=gameState[45],e[46]=gameState[46],e[47]=gameState[47],e[48]=gameState[48],e[49]=gameState[49],e[50]=gameState[50],e[51]=gameState[51],e[52]=gameState[52],e[53]=gameState[53],e[55]=gameState[55],saveLastRestart(gameState[9]+1),gameState=e,saveGame(gameState),lockSaving=!0,location.reload(),closePopUp()})},renderPlayerCurrentGold=()=>{playerCurrentGoldElement.innerHTML=formatNumber(gameState[8],!0)},getSkillBonus=(e,t=null,a=!1)=>{if(null===e){for(let a=0;a<getLength(gameState[15]);a++)if(gameState[15][a]==t){e=a;break}if(null===e)return a?1:0}else t=gameState[15][e];const l=gameState[16][e],n=skills[t];return a?(1+.01*m.floor(n[3]*l*100))*gameState[35]:t==skillKey.necromancy&&l>=25?m.floor(25*n[3]*100*gameState[35]):m.floor(n[3]*l*100*gameState[35])},renderPlayerGoldPerSecond=()=>{playerGoldPerSecondElement.innerHTML=`+${formatNumber(10*m.pow(gameState[22],gameState[9])*gameState[35]*getSkillBonus(null,skillKey.prosperity,!0))}/s`},skillAtLevelCost=(e,t)=>m.ceil(e[4]*m.pow(e[5],t)),getSkillUpgradeCost=(e,t)=>{const a=skills[e];let l=0,n=0;do{if(e==skillKey.necromancy&&t+l>=25)break;if(l+=1,n+=skillAtLevelCost(a,t+l),99999999==gameState[38]&&gameState[8]<n){l>1&&(n-=skillAtLevelCost(a,t+l)),l-=1;break}}while(l<gameState[38]);return[n,l]},getUnusedSkills=()=>m.min(6,m.floor(gameState[4]/6))-getLength(gameState[15]),addLockIcon=e=>{const t=getElemBySelector(e);for(let e=0;e<getLength(t);e++)gameState[34]?insertHtml(t[e],afterbegin,"🔒"):insertHtml(t[e],afterbegin,svg("M32 2c-10 0-18 8-18 19v9h6v-9a12 12 0 1124 0v9h6v-9c0-10-8-19-18-19zM11 32l-3 9c0 12 10 21 24 21 13 0 24-9 24-21l-3-9zm21 3c3 0 5 2 5 5 0 2-1 4-3 5l4 12H26l4-12a5 5 0 012-10z"))},renderNotifications=()=>{let e,t=!1;for(let a=0;a<getLength(gameState[15]);a++)if(e=getSkillUpgradeCost(gameState[15][a],gameState[16][a]),gameState[8]>=e[0]){if(gameState[15][a]==skillKey.necromancy&&gameState[16][a]>=25)continue;t=!0;break}navSkillsElement.classList.toggle("dd",t),navSkillsElement.classList.toggle("cc",getUnusedAttributes()>0),navSkillsElement.classList.toggle("bb",getUnusedSkills()>0);const a=getLength(gameState[23])+getLength(gameState[40])+getLength(gameState[41])-lastTrophyNotification;navTrophiesElement.classList.toggle("dd",a>=1),navTrophiesElement.classList.toggle("cc",a>=3),navTrophiesElement.classList.toggle("bb",a>=5);const l=gameState[45].reduce((e,t)=>e+t,0)-lastMoralityNotification;navMoralityElement.classList.toggle("dd",l>=1),navMoralityElement.classList.toggle("cc",l>=5),navMoralityElement.classList.toggle("bb",l>=10)},renderPlayerSkills=()=>{const e=getUnusedSkills();e>0?(skillTitleElement.innerText="Pick a Skill",skillLockElement.className=""):(skillTitleElement.innerText="Upgrade a Skill",skillLockElement.classList.add("done"));let t="";if(goldAmountsToCheck=[],lostGoldAmountsToCheck=[],e>0){let e=0;for(let a=0;a<getLength(skills)&&(gameState[15].includes(a)||gameState[15].includes(""+a)||(t+=`<a href="#" class="open ac" data-id="${a}"><strong>${skills[a][0]}</strong><span>${skills[a][1]}</span></a>`,e+=1,!(e>=6)));a++);}else{let e,a;for(let l=0;l<getLength(gameState[15]);l++)e="ab",a=getSkillUpgradeCost(gameState[15][l],gameState[16][l]),gameState[8]>=a[0]?(e+=" open",lostGoldAmountsToCheck.push(a[0])):goldAmountsToCheck.push(a[0]),gameState[15][l]==skillKey.necromancy&&gameState[16][l]>=25?(e="ab",t+=`<a href="#" class="${e}" data-id="${l}"><div><span class="skillStats"><span class="skillLevelInfo">lvl ${formatNumber(gameState[16][l],!0)} / </span>+${formatNumber(getSkillBonus(l),!0)}%</span><span>${skills[gameState[15][l]][0]}</span></div><div class="cost"><span>MAX</span><span class="buy">lvl</span></div></a>`):t+=`<a href="#" class="${e}" data-id="${l}"><div><span class="skillStats"><span class="skillLevelInfo">lvl ${formatNumber(gameState[16][l],!0)} / </span>+${formatNumber(getSkillBonus(l),!0)}%</span><span>${skills[gameState[15][l]][0]}</span></div><div class="cost"><span>${formatNumber(a[0])}</span><span class="buy">Buy</span></div></a>`;getLength(gameState[15])<6&&(t+=`<a href="#" class="ea"><span>lvl ${m.round(6*(getLength(gameState[15])+1))}</span></a>`)}goldAmountsToCheck=goldAmountsToCheck.sort(),lostGoldAmountsToCheck=lostGoldAmountsToCheck.sort((e,t)=>t-e),skillLockElement.innerHTML=t,addLockIcon(".ea"),renderNotifications()},addPlayerGold=e=>{const t=e*gameState[35]*getSkillBonus(null,skillKey.prosperity,!0);gameState[8]+=t,gameState[25]+=t;for(let e=0;e<getLength(goldAmountsToCheck);e++)if(gameState[8]>=goldAmountsToCheck[e]){renderPlayerSkills();break}renderPlayerCurrentGold()},removePlayerGold=e=>{gameState[8]-=e;for(let e=0;e<getLength(lostGoldAmountsToCheck);e++)if(gameState[8]<lostGoldAmountsToCheck[e]){renderPlayerSkills();break}renderPlayerCurrentGold()},expNeededForLevel=e=>m.pow(m.pow(e-1,2)+4,2),expNeededForNextLevel=e=>expNeededForLevel(e+1)-expNeededForLevel(e),renderPlayerLevel=()=>{playerCurrentLevelElement.innerHTML="lvl "+formatNumber(gameState[4],!0)},renderPlayerNextLevelProgress=()=>{playerNextLevelProgressElement.innerHTML=m.round((expNeededForNextLevel(gameState[4])-(expNeededForNextLevel(gameState[4])-(gameState[5]-expNeededForLevel(gameState[4]))))/expNeededForNextLevel(gameState[4])*100)+"%"},unlockTabs=()=>{if(gameState[4]>=2){navSkillsElement.classList.add("k");const e=getElemBySelector(".c",navSkillsElement);getLength(e)>0&&e[0]&&e[0].remove()}if(gameState[4]>=10&&(setStyle(getElemById("e"),"display","flex"),setStyle(getElemById("d"),"display","none")),gameState[4]>=30||gameState[32]){navMoralityElement.classList.add("k");const e=navMoralityElement.getElementsByClassName("c");getLength(e)>0&&e[0]&&e[0].remove()}},renderPlayerAttributes=()=>{getUnusedAttributes()>0?getElemById("qq").innerHTML=`Stats (${getUnusedAttributes()})`:getElemById("qq").innerHTML="Stats",attributeBlockElement.classList.toggle("done",getUnusedAttributes()<1),attackAttributeValueElement.innerHTML=formatNumber(gameState[6]+gameState[36],!0),defenseAttributeValueElement.innerHTML=formatNumber(gameState[7]+gameState[37],!0)},unlockSkills=()=>{gameState[4]>=6&&(skillLockElement&&(skillLockElement.innerHTML="",skillLockElement.classList.remove("lock")),renderPlayerSkills(),renderNotifications())},renderTrophies=()=>{let e,t,a;const l=[[],[],[]];for(let e=0;e<getLength(Object.keys(trophyKey));e++)l[0].push(0),l[1].push(0),l[2].push(0);trophyListElement.innerHTML="",gameState[23]=[],gameState[40]=[],gameState[41]=[];const n={[trophyKey.skeleton]:{icon:units[0][0],icon2:units[0][1],check:gameState[24][0],title:"Resurrect XXX Skeletons (ZZZ)",special:"<br><span style='color: AAA'>Unlocks Skeleton auto generator!</span>"},[trophyKey.zombie]:{icon:units[1][0],icon2:units[1][1],check:gameState[24][1],title:"Resurrect XXX Zombies (ZZZ)",special:"<br><span style='color: AAA'>Unlocks Zombie auto generator!</span>"},[trophyKey.wight]:{icon:units[2][0],icon2:units[2][1],check:gameState[24][2],title:"Resurrect XXX Wights (ZZZ)",special:"<br><span style='color: AAA'>Unlocks Wight auto generator!</span>"},[trophyKey.vampire]:{icon:units[3][0],icon2:units[3][1],check:gameState[24][3],title:"Resurrect XXX Vampires (ZZZ)",special:"<br><span style='color: AAA'>Unlocks Vampire auto generator!</span>"},[trophyKey.grimReaper]:{icon:units[4][0],icon2:units[4][1],check:gameState[24][4],title:"Resurrect XXX Grim Reapers (ZZZ)",special:"<br><span style='color: AAA'>Unlocks Grim Reaper auto generator!</span>"},[trophyKey.boneDragon]:{icon:units[5][0],icon2:units[5][1],check:gameState[24][5],title:"Resurrect XXX Bone Dragons (ZZZ)",special:"<br><span style='color: AAA'>Unlocks Bone Dragon auto generator!</span>"},[trophyKey.gold]:{icon:uiIcons.gold,icon2:premiumIcons.gold,check:gameState[25],title:"Gain XXX Gold (ZZZ)"},[trophyKey.level]:{icon:uiIcons.level,icon2:premiumIcons.level,check:gameState[26],title:"Reach Level XXX (ZZZ)"},[trophyKey.attack]:{icon:uiIcons.battle,icon2:premiumIcons.battle,check:gameState[27],title:"Gain XXX Attack (ZZZ)"},[trophyKey.defense]:{icon:uiIcons.battle,icon2:"🛡️",check:gameState[28],title:"Gain XXX Defense (ZZZ)"},[trophyKey.skillUpgrades]:{icon:uiIcons.book,icon2:premiumIcons.book,check:gameState[29],title:"Upgrade Skills XXX Times (ZZZ)"},[trophyKey.enemiesKilled]:{icon:units[4][0],icon2:"😵",check:gameState[30],title:"Kill XXX Enemy Units (ZZZ)"},[trophyKey.morality]:{icon:uiIcons.morality,icon2:premiumIcons.morality,check:gameState[32],title:"Reach Morality (ZZZ)"},[trophyKey.stage]:{icon:uiIcons.trophy,icon2:premiumIcons.trophy,check:gameState[31],title:"Beat Stage XXX (ZZZ)"},[trophyKey.souls]:{icon:uiIcons.soul,icon2:premiumIcons.soul,check:gameState[50],title:"Gain XXX souls (ZZZ)"},[trophyKey.soulsSkeleton]:{icon:units[0][0],icon2:units[0][1],check:gameState[46][0],title:"Infuse XXX souls into Skeletons (ZZZ)",special:"<br><span style='color: AAA'>Unlocks Skeleton glow and ability to attack flying units!</span>"},[trophyKey.soulsZombie]:{icon:units[1][0],icon2:units[1][1],check:gameState[46][1],title:"Infuse XXX souls into Zombies (ZZZ)",special:"<br><span style='color: AAA'>Unlocks Zombie glow and improves their defense based on current stage!</span>"},[trophyKey.soulsWight]:{icon:units[2][0],icon2:units[2][1],check:gameState[46][2],title:"Infuse XXX souls into Wights (ZZZ)",special:"<br><span style='color: AAA'>Unlocks Wight glow and improves their experience gain based on souls infused and stage reached!</span>"},[trophyKey.soulsVampire]:{icon:units[3][0],icon2:units[3][1],check:gameState[46][3],title:"Infuse XXX souls into Vampires (ZZZ)",special:"<br><span style='color: AAA'>Unlocks Vampire glow, improves their defense based on current stage and ability to attack flying units!</span>"},[trophyKey.soulsGrimReaper]:{icon:units[4][0],icon2:units[4][1],check:gameState[46][4],title:"Infuse XXX souls into Grim Reapers (ZZZ)",special:"<br><span style='color: AAA'>Unlocks Grim Reaper glow and ability to attack flying units!</span>"},[trophyKey.soulsBoneDragon]:{icon:units[5][0],icon2:units[5][1],check:gameState[46][5],title:"Infuse XXX souls into Bone Dragons (ZZZ)",special:"<br><span style='color: AAA'>Unlocks Bone Dragon glow and improves their defense based on current stage!</span>"},[trophyKey.color]:{icon:uiIcons.morality,icon2:premiumIcons.morality,check:"check-color",title:"Infuse unit with XXX souls",special:"Infuse unit with XXX souls"},[trophyKey.colorTwo]:{icon:uiIcons.morality,icon2:premiumIcons.morality,check:"check-color",title:"Infuse two units with XXX souls accordingly",special:"Infuse two units with XXX souls accordingly"},[trophyKey.colorAll]:{icon:uiIcons.morality,icon2:premiumIcons.morality,check:"check-color",title:"Infuse all units with XXX souls accordingly",special:"Infuse all units with XXX souls accordingly"}};for(let o=0;o<getLength(trophies);o++){e=gameState[34]?n[trophies[o].type].icon2:n[trophies[o].type].icon,n[trophies[o].type].check>=trophies[o].value&&gameState[23].push(o),t=n[trophies[o].type].title.replace("XXX",formatNumber(trophies[o].value)).replace("YYY",formatNumber(n[trophies[o].type].check)).replace("ZZZ",Math.min(100,Math.max(0,Math.floor(n[trophies[o].type].check/trophies[o].value*100)))+"%");const s=trophyColors[l[0][trophies[o].type]];a='class="kk"',trophies[o].special&&(t+=n[trophies[o].type].special.replace("AAA",s),a='class="kk special"'),1==openTrophyTier&&gameState[23].includes(o)&&(a='class="kk ad"',trophies[o].special&&(gameState[39][trophies[o].type]=!0,a='class="kk ad special"')),1==openTrophyTier&&('class="kk"'==a||'class="kk special"'==a?gameState[34]?trophyListElement.innerHTML+=`<li style="position: relative; box-shadow: 0 0 5px 0 #444; background: #444" ${a} title="${t.replace(/<\/?[^>]+(>|$)/g," ")}" data-title="${t}"><span style="text-shadow: 0 2px 10px #000">${e}</span><div class="ae"></div></li>`:trophyListElement.innerHTML+=`<li ${a} title="${t.replace(/<\/?[^>]+(>|$)/g," ")}" data-title="${t}">${e.replace("<path ",'<path fill="#444" ')}</li>`:gameState[34]?trophyListElement.innerHTML+=`<li style="position: relative; box-shadow: 0 0 5px 0 ${s}; background: ${s}aa" ${a} title="${t.replace(/<\/?[^>]+(>|$)/g," ")}" data-title="${t}"><span style="text-shadow: 0 2px 10px #000">${e}</span><div class="ae"></div></li>`:trophies[o].special?trophyListElement.innerHTML+=`<li style="box-shadow: 0 0 10px ${s}!important;" ${a} title="${t.replace(/<\/?[^>]+(>|$)/g," ")}" data-title="${t}">${e.replace("<path ",`<path fill="${s}" `)}</li>`:trophyListElement.innerHTML+=`<li ${a} title="${t.replace(/<\/?[^>]+(>|$)/g," ")}" data-title="${t}">${e.replace("<path ",`<path fill="${s}" `)}</li>`),l[0][trophies[o].type]+=1}if(getLength(gameState[23])==getLength(trophies))for(let o=0;o<getLength(trophiesTier2);o++){e=gameState[34]?n[trophiesTier2[o].type].icon2:n[trophiesTier2[o].type].icon,n[trophiesTier2[o].type].check>=trophiesTier2[o].value&&gameState[40].push(o),t=n[trophiesTier2[o].type].title.replace("XXX",formatNumber(trophiesTier2[o].value)).replace("YYY",formatNumber(n[trophiesTier2[o].type].check)).replace("ZZZ",Math.min(100,Math.max(0,Math.floor(n[trophiesTier2[o].type].check/trophiesTier2[o].value*100)))+"%");const s=trophyColors[l[1][trophiesTier2[o].type]];a='class="kk"',trophiesTier2[o].special&&(t+=n[trophiesTier2[o].type].special.replace("AAA",s),a='class="kk special"'),2==openTrophyTier&&gameState[40].includes(o)&&(a='class="kk ad"',trophiesTier2[o].special&&(a='class="kk ad special"')),2==openTrophyTier&&('class="kk"'==a||'class="kk special"'==a?gameState[34]?trophyListElement.innerHTML+=`<li style="position: relative; box-shadow: 0 0 5px 0 #444; background: #444" ${a} title="${t.replace(/<\/?[^>]+(>|$)/g," ")}" data-title="${t}"><span style="text-shadow: 0 2px 10px #000">${e}</span><div class="ae"></div></li>`:trophyListElement.innerHTML+=`<li ${a} title="${t.replace(/<\/?[^>]+(>|$)/g," ")}" data-title="${t}">${e.replace("<path ",'<path fill="#444" ')}</li>`:gameState[34]?trophyListElement.innerHTML+=`<li style="position: relative; box-shadow: 0 0 5px 0 ${s}; background: ${s}aa" ${a} title="${t.replace(/<\/?[^>]+(>|$)/g," ")}" data-title="${t}"><span style="text-shadow: 0 2px 10px #000">${e}</span><div class="ae"></div></li>`:trophiesTier2[o].special?trophyListElement.innerHTML+=`<li style="box-shadow: 0 0 10px ${s}!important;" ${a} title="${t.replace(/<\/?[^>]+(>|$)/g," ")}" data-title="${t}">${e.replace("<path ",`<path fill="${s}" `)}</li>`:trophyListElement.innerHTML+=`<li ${a} title="${t.replace(/<\/?[^>]+(>|$)/g," ")}" data-title="${t}">${e.replace("<path ",`<path fill="${s}" `)}</li>`),l[1][trophiesTier2[o].type]+=1}if(getLength(gameState[40])==getLength(trophiesTier2))for(let o=0;o<getLength(trophiesTier3);o++){e=gameState[34]?n[trophiesTier3[o].type].icon2:n[trophiesTier3[o].type].icon,"check-color"==n[trophiesTier3[o].type].check?gameState[53][trophiesTier3[o].key]&&gameState[41].push(o):n[trophiesTier3[o].type].check>=trophiesTier3[o].value&&gameState[41].push(o);let s=trophyColors[l[2][trophiesTier3[o].type]];if("check-color"==n[trophiesTier3[o].type].check){let e="";trophiesTier3[o].type==trophyKey.color?(e=`rrr${trophiesTier3[o].value[0]}rrr red, ggg${trophiesTier3[o].value[1]}ggg green and bbb${trophiesTier3[o].value[2]}bbb blue`,s=[255,255,255],s[1]-=5*trophiesTier3[o].value[0],s[2]-=5*trophiesTier3[o].value[0],s[0]-=5*trophiesTier3[o].value[1],s[2]-=5*trophiesTier3[o].value[1],s[0]-=5*trophiesTier3[o].value[2],s[1]-=5*trophiesTier3[o].value[2],s=`rgb(${s[0]}, ${s[1]}, ${s[2]})`):trophiesTier3[o].value.forEach((t,a,l)=>{a===l.length-1?e+=` and rrr${t[0]}rrr-ggg${t[1]}ggg-bbb${t[2]}bbb`:e+=0===a?`rrr${t[0]}rrr-ggg${t[1]}ggg-bbb${t[2]}bbb`:`, rrr${t[0]}rrr-ggg${t[1]}ggg-bbb${t[2]}bbb`}),t=n[trophiesTier3[o].type].title.replace("XXX",e)}else t=n[trophiesTier3[o].type].title.replace("XXX",formatNumber(trophiesTier3[o].value)).replace("YYY",formatNumber(n[trophiesTier3[o].type].check)).replace("ZZZ",Math.min(100,Math.max(0,Math.floor(n[trophiesTier3[o].type].check/trophiesTier3[o].value*100)))+"%");trophiesTier3[o].secret&&1!=gameState[53][trophiesTier3[o].key]&&(t="?????"),a='class="kk"',trophiesTier3[o].special&&("check-color"!=n[trophiesTier3[o].type].check&&(t+=n[trophiesTier3[o].type].special.replace("AAA",s)),a='class="kk special"'),3==openTrophyTier&&gameState[41].includes(o)&&(a='class="kk ad"',trophiesTier3[o].special&&(a='class="kk ad special"')),3==openTrophyTier&&('class="kk"'==a||'class="kk special"'==a?gameState[34]?trophyListElement.innerHTML+=`<li style="position: relative; box-shadow: 0 0 5px 0 #444; background: #444" ${a} data-name="${trophiesTier3[o].name}" title="${t.replace(/<\/?[^>]+(>|$)/g," ")}" data-title="${t}"><span style="text-shadow: 0 2px 10px #000">${e}</span><div class="ae"></div></li>`:trophyListElement.innerHTML+=`<li ${a} data-name="${trophiesTier3[o].name}" title="${t.replace(/<\/?[^>]+(>|$)/g," ")}" data-title="${t}">${e.replace("<path ",'<path fill="#444" ')}</li>`:gameState[34]?trophyListElement.innerHTML+=`<li style="position: relative; box-shadow: 0 0 5px 0 ${s}; background: ${s}aa" ${a} data-name="${trophiesTier3[o].name}" title="${t.replace(/<\/?[^>]+(>|$)/g," ")}" data-title="${t}"><span style="text-shadow: 0 2px 10px #000">${e}</span><div class="ae"></div></li>`:"check-color"==n[trophiesTier3[o].type].check?trophiesTier3[o].special?trophyListElement.innerHTML+=`<li style="box-shadow: 0 0 10px ${s}!important;" ${a} data-name="${trophiesTier3[o].name}" title="${t.replace(/<\/?[^>]+(>|$)/g," ")}" data-title="${t}">${e.replace("<path ",`<path fill="${s}" `).replace("<svg",`<svg style="filter: contrast(.5) brightness(1.5); fill: ${s};"`)}</li>`:trophyListElement.innerHTML+=`<li ${a} data-name="${trophiesTier3[o].name}" title="${t.replace(/<\/?[^>]+(>|$)/g," ")}" data-title="${t}">${e.replace("<path ",`<path fill="${s}" `).replace("<svg",`<svg style="filter: contrast(.5) brightness(1.5); fill: ${s};"`)}</li>`:trophiesTier3[o].special?trophyListElement.innerHTML+=`<li style="box-shadow: 0 0 10px ${s}!important;" ${a} data-name="${trophiesTier3[o].name}" title="${t.replace(/<\/?[^>]+(>|$)/g," ")}" data-title="${t}">${e.replace("<path ",`<path fill="${s}" `)}</li>`:trophyListElement.innerHTML+=`<li ${a} data-name="${trophiesTier3[o].name}" title="${t.replace(/<\/?[^>]+(>|$)/g," ")}" data-title="${t}">${e.replace("<path ",`<path fill="${s}" `)}</li>`),l[2][trophiesTier3[o].type]+=1}if(1==openTrophyTier?trophyTitleElement.innerHTML=`Trophies - ${getLength(gameState[23])}/${getLength(trophies)}`:2==openTrophyTier?trophyTitleElement.innerHTML=`Trophies - ${getLength(gameState[40])}/${getLength(trophiesTier2)}`:3==openTrophyTier&&(trophyTitleElement.innerHTML=`Trophies - ${getLength(gameState[41])}/${getLength(trophiesTier3)}`),getLength(gameState[23])==getLength(trophies)){unlockThemes(),0==gameState[43]&&(gameState[43]=!0,openPopUp("<strong>Tier 2 trophies unlocked!</strong>"),saveGame(gameState)),0==gameState[54]&&"spiritdungeons.com"==location.hostname&&(fetch("https://spiritdungeons.com/game-complete"),gameState[54]=!0,saveGame(gameState)),document.getElementById("t2-tab").classList.remove("tier-locked");const e=document.querySelector("#t2-tab svg");if(e&&e.remove(),getLength(gameState[40])==getLength(trophiesTier2)){0==gameState[44]&&(gameState[44]=!0,openPopUp("<strong>Tier 3 trophies unlocked!</strong>"),saveGame(gameState)),document.getElementById("t3-tab").classList.remove("tier-locked");const e=document.querySelector("#t3-tab svg");e&&e.remove(),getLength(gameState[41])==getLength(trophiesTier3)&&0==gameState[42]&&(openBigPopUp(`<div style="text-shadow: 1px 1px 2px #000; color: #bbb;"><p><strong style="font-size: 1.5rem;">🥳 Congratulations! 🥳</strong></p><p>You have beaten the game in <strong>${convertMS(gameState[1])}</strong>! Well done!</p><p>Now, come join us in <a style="color: #4d84b9;" href="https://discord.gg/HBqCfc9" target="_blank">Discord</a> or sign up for <a style="color: #4d84b9;" href="https://spiritdungeons.com/waitlist/?ref=soul-not-found">the waitlist</a> to be notified when <a style="color: #4d84b9;" href="https://spiritdungeons.com/?ref=soul-not-found">the full version</a> of the game is out!</p></div>`),gameState[42]=!0,saveGame(gameState))}}gameState[35]=1+.01*m.floor(1.5*getLength(gameState[23]))+.01*m.floor(10*getLength(gameState[40]))+.01*m.floor(100*getLength(gameState[41])),getElemById("kk").innerText=m.round(100*(gameState[35]-1))+"%",renderNotifications(),renderPlayerGoldPerSecond(),renderPlayerSkills()},openTrophyTierTab=e=>{if(1==e&&document.getElementById("t1-tab").classList.contains("tier-locked"))return;if(2==e&&document.getElementById("t2-tab").classList.contains("tier-locked"))return;if(3==e&&document.getElementById("t3-tab").classList.contains("tier-locked"))return;const t=document.getElementById("t1-tab"),a=document.getElementById("t2-tab"),l=document.getElementById("t3-tab");t.classList.toggle("active",!1),a.classList.toggle("active",!1),l.classList.toggle("active",!1),1==e?t.classList.toggle("active",!0):2==e?a.classList.toggle("active",!0):3==e&&l.classList.toggle("active",!0),openTrophyTier=e,gameState[52]&&changeTabSound[getRandomInt(0,4)].play(),renderTrophies()},levelUpPlayer=(e=1)=>{gameState[4]+=e,gameState[4]>gameState[26]&&(gameState[26]=gameState[4]),gameState[4]>=30&&(gameState[32]=1),renderTrophies(),unlockSkills(),saveGame(gameState),unlockTabs(),renderPlayerAttributes(),renderPlayerLevel(),renderNotifications()},getEnemyLevels=e=>{const t=[];for(let a=0;a<getLength(units)&&!(unitUnlockLevel[a]>e);a++)t.push(m.floor(m.sqrt(m.pow(1.25,5+e-unitUnlockLevel[a]/2))));return t},pickSkill=e=>{getUnusedSkills()<=0||null===e||openPopUpConfirm(`Pick <strong>${skills[e][0]}</strong>?`,"No","Yes",()=>{gameState[15].push(e),gameState[16].push(0),renderPlayerSkills(),renderNotifications(),closePopUp()})},upgradeSkill=e=>{if(null===e)return;const t=gameState[15][e],a=gameState[16][e],l=getSkillUpgradeCost(t,a);gameState[15][e]==skillKey.necromancy&&gameState[16][e]>=25||gameState[8]>=l[0]&&(gameState[38]>10?gameState[52]&&buyBigSound[getRandomInt(0,4)].play():gameState[52]&&buySmallSound[getRandomInt(0,4)].play(),gameState[16][e]+=l[1],gameState[29]+=l[1],removePlayerGold(l[0]),renderPlayerSkills(),renderNotifications(),renderPlayerGoldPerSecond())},addPlayerExperience=e=>{gameState[5]+=15*e*getSkillBonus(null,skillKey.learning,!0);let t=0;for(;gameState[5]>=expNeededForLevel(gameState[4]+1+t);)t+=1;t>=1&&levelUpPlayer(t),renderPlayerNextLevelProgress()},renderUnitToUpgrade=()=>{const e=document.getElementById("player-unit-to-uprade");e.innerHTML="";const t=gameState[49];let a="",l="";gameState[48][t].reduce((e,t)=>e+t,0)>=51&&(l="max-color"),gameState[34]?a+=`<strong>${units[t][1]}</strong>`:gameState[46][t]>=51?a+=units[t][0].replace("<svg ",`<svg style="filter: contrast(.5) brightness(1.5) drop-shadow(0px 0px 5px rgb(${gameState[47][t][0]}, ${gameState[47][t][1]}, ${gameState[47][t][2]})); fill: rgb(${gameState[47][t][0]}, ${gameState[47][t][1]}, ${gameState[47][t][2]})" id="p-${t}" `):a+=units[t][0].replace("<svg ",`<svg style="filter: contrast(.5) brightness(1.5); fill: rgb(${gameState[47][t][0]}, ${gameState[47][t][1]}, ${gameState[47][t][2]})" id="p-${t}" `),a+=`<div id="player-unit-damage-bonus" class="${l}">\n\t\t<div class="color-amount"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="fill: #d64242; filter: drop-shadow(0px 0px 10px #000);"><defs/><path d="M261 18c-41 189-161 189-161 322 0 89 82 153 161 153 81 0 158-64 158-147 0-127-116-139-158-328zm-96 207c20 28 49 50 85 67-53 34-105 4-85-67zm186 0c20 71-32 101-85 67 36-17 65-39 85-67zm-228 91c13 15 32 29 53 39 1 19 7 34 24 53-1-16 0-31 3-43a207 207 0 00111 1c3 12 4 26 3 42 16-19 23-33 24-52 23-10 42-24 56-40-2 57-41 105-94 122l-11-34-13 39a143 143 0 01-38 0l-13-39-11 34c-53-17-92-65-94-122z"/></svg><span>${formatNumber(gameState[48][t][0],!0)}</span></div>\n\t\t<div class="color-amount"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="fill: #48b138; filter: drop-shadow(0px 0px 10px #000);"><defs/><path d="M261 18c-41 189-161 189-161 322 0 89 82 153 161 153 81 0 158-64 158-147 0-127-116-139-158-328zm-96 207c20 28 49 50 85 67-53 34-105 4-85-67zm186 0c20 71-32 101-85 67 36-17 65-39 85-67zm-228 91c13 15 32 29 53 39 1 19 7 34 24 53-1-16 0-31 3-43a207 207 0 00111 1c3 12 4 26 3 42 16-19 23-33 24-52 23-10 42-24 56-40-2 57-41 105-94 122l-11-34-13 39a143 143 0 01-38 0l-13-39-11 34c-53-17-92-65-94-122z"/></svg><span>${formatNumber(gameState[48][t][1],!0)}</span></div>\n\t\t<div class="color-amount"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="fill: #5373d8; filter: drop-shadow(0px 0px 10px #000);"><defs/><path d="M261 18c-41 189-161 189-161 322 0 89 82 153 161 153 81 0 158-64 158-147 0-127-116-139-158-328zm-96 207c20 28 49 50 85 67-53 34-105 4-85-67zm186 0c20 71-32 101-85 67 36-17 65-39 85-67zm-228 91c13 15 32 29 53 39 1 19 7 34 24 53-1-16 0-31 3-43a207 207 0 00111 1c3 12 4 26 3 42 16-19 23-33 24-52 23-10 42-24 56-40-2 57-41 105-94 122l-11-34-13 39a143 143 0 01-38 0l-13-39-11 34c-53-17-92-65-94-122z"/></svg><span>${formatNumber(gameState[48][t][2],!0)}</span></div>\n\t\t<strong id="max-color" style="color: rgb(${gameState[47][t][0]}, ${gameState[47][t][1]}, ${gameState[47][t][2]})">MAX</strong>\n\t\t<span id="max-color-span">COLOR</span>\n\t</div>`,e.innerHTML=a},renderUpgradeableUnits=()=>{const e=document.getElementById("select-unit-to-upgrade");e.innerHTML="";let t="";for(let e=0;e<getLength(gameState[12]);e++)t+=`<div data-id="${e}" class="upgradable-unit">`,gameState[34]?t+=`<strong>${units[e][1]}</strong>`:gameState[46][e]>=51?t+=units[e][0].replace("<svg ",`<svg style="filter: contrast(.5) brightness(1.5) drop-shadow(0px 0px 5px rgb(${gameState[47][e][0]}, ${gameState[47][e][1]}, ${gameState[47][e][2]})); fill: rgb(${gameState[47][e][0]}, ${gameState[47][e][1]}, ${gameState[47][e][2]})" id="p-${e}" `):t+=units[e][0].replace("<svg ",`<svg style="filter: contrast(.5) brightness(1.5); fill: rgb(${gameState[47][e][0]}, ${gameState[47][e][1]}, ${gameState[47][e][2]})" id="p-${e}" `),t+=`<span class="be">${formatNumber(gameState[46][e],!0)}%</span>`,t+="</div>";e.innerHTML=t},renderMorality=()=>{const e=document.getElementById("red-soul-count"),t=document.getElementById("green-soul-count"),a=document.getElementById("blue-soul-count");e.innerHTML=gameState[45][0],t.innerHTML=gameState[45][1],a.innerHTML=gameState[45][2],renderUnitToUpgrade(),renderUpgradeableUnits()},openTab=(e,t,a)=>{if(null!=t&&t.preventDefault(),1==a&&gameState[4]<2)return;if(2==a&&gameState[4]<30&&!gameState[32])return;3==a&&(lastTrophyNotification=getLength(gameState[23])+getLength(gameState[40])+getLength(gameState[41]),renderNotifications()),2==a&&(lastMoralityNotification=gameState[45].reduce((e,t)=>e+t,0),renderNotifications(),renderMorality()),setStyle(tabContent[0],"display","none"),setStyle(tabContent[1],"display","none"),setStyle(tabContent[2],"display","none"),setStyle(tabContent[3],"display","none"),setStyle(tabContent[4],"display","none");const l=getElemBySelector("#nav a");for(let e=0;e<getLength(l);e++)l[e].classList.remove("n");gameState[52]&&changeTabSound[getRandomInt(0,4)].play(),setStyle(tabContent[a],"display","inherit"),e.classList.add("n"),closePopUp()},renderStageNumber=()=>{stageCurrentElement.innerHTML="Stage #"+(gameState[9]+1)},renderEnemyUnits=()=>{enemy.innerHTML="";let e="";const t=getEnemyLevels(gameState[9]);for(let a=0;a<getLength(t);a++)t[a]<=0||(0==gameState[10][a]?e+=`<div id="e-${a}-b" class="eb af">`:e+=`<div id="e-${a}-b" class="eb">`,e+=`<span id="e-${a}-a">${formatNumber(gameState[10][a],!0)}</span>`,gameState[34]?e+=`<strong id="e-${a}">${units[a][1]}</strong>`:e+=units[a][0].replace("<svg ",`<svg id="e-${a}" `),e+="</div>");enemy.innerHTML=e},renderUnitGenerationProgress=()=>{if(null===gameState[17])return;const e=m.max(.1,1-.01*getSkillBonus(null,skillKey.necromancy));let t=m.max(.01,1-m.pow(gameState[9]+1,2)/24e3),a=!1;for(let e=0;e<gameState[15].length;e++)if(gameState[15][e]==skillKey.necromancy){a=!0;break}a||(t=1);const l=[];for(let e=0;e<units.length;e++){let t=1;for(let a=0;a<gameState[15].length;a++)if(gameState[15][a]>=5&&gameState[15][a]==e+5){t=1/gameState[16][a]*(e+1)*10;break}l.push(t)}let n=!1;for(let a=0;a<gameState[12].length;a++)gameState[39][a]&&(0==a&&(n=!0),playerUnitTimeProgressElements[a].innerHTML=m.floor(m.max(0,m.min(100,gameState[14][a]/(units[a][2]*e*l[a]*t)*100)))+"%");!n&&0!=gameState[17]&&gameState[12].length>=5&&gameState[12][4]>0&&(playerUnitTimeProgressElements[0].innerHTML=m.floor(m.max(0,m.min(100,gameState[14][0]/(units[0][2]*e*l[0]*t)*100)))+"%"),playerUnitTimeProgressElements[gameState[17]].innerHTML=m.floor(m.max(0,m.min(100,gameState[14][gameState[17]]/(units[gameState[17]][2]*e*l[gameState[17]]*t)*100)))+"%"},renderPlayerUnit=e=>{null!==gameState[17]&&(gameState[12][e]>0&&playerUnitElements[e].classList.remove("af"),playerUnitAmountElements[e].innerHTML=formatNumber(gameState[12][e],!0))},renderPlayerUnits=()=>{player.innerHTML="";let e="";for(let t=0;t<getLength(gameState[12]);t++)0==gameState[12][t]?gameState[17]===t?e+=`<div id="p-${t}-b" data-id="${t}" class="eb af n">`:e+=`<div id="p-${t}-b" data-id="${t}" class="eb af">`:gameState[17]===t?e+=`<div id="p-${t}-b" data-id="${t}" class="eb n">`:e+=`<div id="p-${t}-b" data-id="${t}" class="eb">`,gameState[34]?e+=`<strong id="p-${t}">${units[t][1]}</strong>`:gameState[46][t]>=51?e+=units[t][0].replace("<svg ",`<svg style="filter: contrast(.5) brightness(1.5) drop-shadow(0px 0px 5px rgb(${gameState[47][t][0]}, ${gameState[47][t][1]}, ${gameState[47][t][2]})); fill: rgb(${gameState[47][t][0]}, ${gameState[47][t][1]}, ${gameState[47][t][2]})" id="p-${t}" `):e+=units[t][0].replace("<svg ",`<svg style="filter: contrast(.5) brightness(1.5); fill: rgb(${gameState[47][t][0]}, ${gameState[47][t][1]}, ${gameState[47][t][2]})" id="p-${t}" `),e+=`<span class="be" id="p-${t}-a">${formatNumber(gameState[12][t],!0)}</span>`,e+='<div class="fc"></div>',e+='<span class="bd"></span></div>';getLength(gameState[12])<getLength(units)&&(e+=`<div class="eb not"><div id="bf" class="c"></div>${units[getLength(gameState[12])][0]}<span class="be">#${unitUnlockLevel[getLength(gameState[12])]+2}</span></div>`),player.innerHTML=e,getLength(gameState[12])<getLength(units)&&firstGameLockDone&&addLockIcon("#bf"),playerUnitElements=player.getElementsByClassName("eb"),playerUnitAmountElements=player.getElementsByClassName("be"),playerUnitTimeProgressElements=player.getElementsByClassName("bd"),renderUnitGenerationProgress()},addAttribute=e=>{const t=getUnusedAttributes();t<=0||(0==e?(gameState[6]+=m.min(t,gameState[38]),gameState[27]+=m.min(t,gameState[38])):1==e&&(gameState[7]+=m.min(t,gameState[38]),gameState[28]+=m.min(t,gameState[38])),gameState[38]>10?gameState[52]&&chooseNewSkillSound.play():gameState[52]&&changeTabSound[getRandomInt(0,4)].play(),renderTrophies(),renderPlayerAttributes(),renderNotifications())},generateUnit=(e,t=!1)=>{if(!inBattle||null===e){for(let e=0;e<getLength(playerUnitElements);e++)playerUnitElements[e].classList.remove("n"),playerUnitElements[e].classList.remove("passive-active");if(gameState[52]&&changeTabSound[getRandomInt(0,4)].play(),t&&gameState[17]===e)gameState[17]=null;else if(gameState[17]=e,playerUnitElements[e]){playerUnitElements[e].classList.add("n");let t=!1;for(let e=0;e<gameState[12].length;e++)gameState[39][e]&&(0==e&&(t=!0),playerUnitElements[e].classList.add("passive-active"));!t&&0!=gameState[17]&&gameState[12].length>=5&&gameState[12][4]>0&&playerUnitElements[0].classList.add("passive-active")}renderPlayerUnit(e),renderUnitGenerationProgress()}},openStage=e=>{if(e!=gameState[9]){gameState[10]=getEnemyLevels(gameState[9]+1);for(let e=0;e<getLength(gameState[10]);e++)0==gameState[10][e]?gameState[11][e]=0:gameState[11][e]=units[e][7]}gameState[9]=e,stageCurrentElement.innerHTML="Stage #"+(gameState[9]+1),renderEnemyUnits(),renderPlayerUnits()},addPlayerUnitGenerationProgress=e=>{if(null===gameState[17])return;const t=gameState[12][4],a=m.max(.1,1-.01*getSkillBonus(null,skillKey.necromancy));let l=m.max(.01,1-m.pow(gameState[9]+1,2)/24e3),n=!1;for(let e=0;e<gameState[15].length;e++)if(gameState[15][e]==skillKey.necromancy){n=!0;break}n||(l=1);const o=[];for(let e=0;e<units.length;e++){let t=1;for(let a=0;a<gameState[15].length;a++)if(gameState[15][a]>=5&&gameState[15][a]==e+5){t=1/gameState[16][a]*(e+1)*10;break}o.push(t)}let s,r;gameState[14][gameState[17]]+=e;let i=!0;gameState[12].length>=5&&gameState[12][4]>0&&(gameState[14][0]+=gameState[12][4]*e*5e-4,i=!1,s=units[0][2]*a*o[0]*l,gameState[14][0]>s&&(r=m.floor(gameState[14][0]/s),gameState[24][0]+=r,gameState[14][0]-=s*r,gameState[12][0]+=r));for(let t=0;t<gameState[12].length;t++)gameState[39][t]&&(gameState[14][t]+=.25*e,s=units[t][2]*a*o[t]*l,gameState[14][t]>s&&(r=m.floor(gameState[14][t]/s),gameState[24][t]+=r,gameState[14][t]-=s*r,gameState[12][t]+=r,0==t&&(i=!0),renderPlayerUnit(t)));s=units[gameState[17]][2]*a*o[gameState[17]]*l,gameState[14][gameState[17]]>s&&(r=m.floor(gameState[14][gameState[17]]/s),gameState[24][gameState[17]]+=r,gameState[14][gameState[17]]-=s*r,gameState[12][gameState[17]]+=r,0==gameState[17]&&(i=!0),renderPlayerUnit(gameState[17])),0==t&&t!=gameState[12][4]&&playerUnitElements[0].classList.add("passive-active"),i||renderPlayerUnit(0)},getDefender=(e,t)=>{let a=null;if("player"==e)if(gameState[12][1]>0)a=1;else{let e=0;for(let a=0;a<getLength(gameState[12]);a++)gameState[12][a]<=0&&(e+=1),5==a&&2!=t&&5!=t&&(e+=1);let l=getRandomInt(0,getLength(gameState[12])-1-e);for(let e=0;e<getLength(gameState[12]);e++)if(!(gameState[12][e]<=0||5==e&&2!=t&&5!=t)){if(0==l){a=e;break}l-=1}}else if(gameState[10][1]>0)a=1;else{let e=0;for(let a=0;a<getLength(gameState[10]);a++)gameState[10][a]<=0&&(e+=1),5==a&&2!=t&&5!=t&&gameState[46][t]<51&&(e+=1);let l=getRandomInt(0,getLength(gameState[10])-1-e);for(let e=0;e<getLength(gameState[10]);e++)if(!(gameState[10][e]<=0||5==e&&2!=t&&5!=t&&gameState[46][t]<51)){if(0==l){a=e;break}l-=1}}return a},resetAttackButton=()=>{0==processingAttackAction&&(attackElement.classList.remove("bc"),attackElement.innerHTML="<span>Attack!</span>")},stopBattle=()=>{inBattle&&(inBattle=!1,resetAttackButton(),generateUnit(unitToRestoreGeneration),gameState[52]&&chooseNewSkillSound.play()),vampireBonus=0,saveGame(gameState)},soulColors=["#d64242","#48b138","#5373d8"],showSoulGainNotification=(e,t)=>{const a=document.querySelector(".color-soul-notifications"),l=document.querySelector(".souls-gained-notification"),n=document.querySelector(".soul-name-count-change");n.innerHTML=e>1?"souls":"soul",l.innerHTML=e,l.style.color=soulColors[t],a.style.opacity=1,a.style.top="4rem",setTimeout(()=>{a.style.opacity=0,a.style.top="3rem"},2500)},addSouls=e=>{let t=0,a=1;e>50&&(t=1),e>100&&(t=5),e>150&&(t=12.5),e>200&&(t=25),e>250&&(t=50,a=getRandomInt(1,2)),e>300&&(t=100,a=getRandomInt(2,3)),e>350&&(a=getRandomInt(3,5)),e>400&&(a=getRandomInt(5,10)),e>450&&(a=getRandomInt(10,20)),e>500&&(a=getRandomInt(20,50));if(getRandomInt(0,100)<t){const e=getRandomInt(0,2);gameState[45][e]+=a,gameState[50]+=a,showSoulGainNotification(a,e),renderMorality()}},openNextStage=()=>{const e=getEnemyLevels(gameState[9]+1);for(let t=0;t<getLength(e);t++)gameState[30]+=e[t];gameState[9]+1>gameState[31]&&(gameState[31]=gameState[9]+1);let t=1;for(let e=0;e<getLength(unitUnlockLevel);e++)unitUnlockLevel[e]<gameState[9]&&(t=e+1);t-=getLength(gameState[12]);for(let e=0;e<t;e++)gameState[13].push(units[getLength(gameState[12])][7]),gameState[12].push(0),gameState[14].push(0);renderTrophies(),gameState[18]=-1,addPlayerExperience(gameState[9]+1),addPlayerGold((gameState[9]+1)*gameState[20]*gameState[21]),addSouls(gameState[9]+1),renderPlayerGoldPerSecond(),openStage(gameState[9]+1),inBattle?(setupAllBattleUnitsBySpeed(),doAnAttack(),resetAttackButton()):(stopBattle(),generateUnit(gameState[17]))},calculateAttackDamage=(e,t,a)=>{let l,n,o,s=0;if(e)l=gameState[12][t],n=gameState[10][a],o=(gameState[36]+gameState[6]+units[t][3])*(1+.01*gameState[46][t])-units[a][4]-10;else{l=gameState[10][t],n=gameState[12][a];let e=1;gameState[46][a]>=51&&(e=1==a?100*(gameState[9]+1):3==a||5==a?50*(gameState[9]+1):1),e=Math.max(1,.01*e),o=units[t][3]-(units[a][4]+gameState[7]+gameState[37])*(1+.01*gameState[46][a])*e}for(let e=0;e<10;e++)s+=getRandomInt(units[t][5],units[t][6]);if(s*=l/10,o>0)s*=e?(1+.05*o)*getSkillBonus(null,skillKey.wrath,!0):1+.05*o;else if(getLength(gameState[23])==getLength(trophies)){let t=1;e?t=m.max(.025,1+.025*o):(t=m.max(.025,1+.025*o*getSkillBonus(null,skillKey.calm,!0)),t<.026&&(t=m.min(.025,100/(m.abs(o)*getSkillBonus(null,skillKey.calm,!0))))),s*=t}else s*=e?m.max(.025,1+.025*o):m.max(.025,1+.025*o*getSkillBonus(null,skillKey.calm,!0));return 0==e||(0==t&&(s*=getSkillBonus(null,skillKey.skeleton,!0)),1==t&&(s*=getSkillBonus(null,skillKey.zombie,!0)),2==t&&(s*=getSkillBonus(null,skillKey.wight,!0)),3==t&&(s*=getSkillBonus(null,skillKey.vampire,!0),s*=vampireBonus),4==t&&(s*=getSkillBonus(null,skillKey.grimReaper,!0)),5==t&&(s*=getSkillBonus(null,skillKey.boneDragon,!0))),m.floor(s)};let setupAllBattleUnitsBySpeed=()=>{gameState[19]=[];for(let e=0;e<getLength(gameState[12]);e++)gameState[19].push(["player",e,units[e][8]]);for(let e=0;e<getLength(gameState[10]);e++)gameState[19].push(["enemy",e,units[e][8]]);gameState[19].sort(orderBySpeed)};const shouldStopBattle=()=>{let e=!0;for(let t=0;t<getLength(gameState[10]);t++)if(gameState[10][t]>0){e=!1;break}if(e)return openNextStage(),!0;let t=!0;for(let e=0;e<getLength(gameState[12]);e++)if(gameState[12][e]>0){t=!1;break}return(t||0==inBattle)&&(stopBattle(),!0)};let doAnAttack=()=>{if(shouldStopBattle())return;gameState[18]=(gameState[18]+1)%getLength(gameState[19]);const e=gameState[19][gameState[18]];let t,a;if("player"==e[0]?(t=gameState[12],a="enemy"):(t=gameState[10],a="player"),t[e[1]]<=0)return void doAnAttack();const l=getDefender(a,e[1]);if(null===l)return void doAnAttack();vampireBonus+=.01;const n=e[0],o=e[1],s=l;let r,i,g,p,c,y,u=30,d=20,h=50,S=100,v=0;"enemy"==n?(r=getElemById("e-"+o),g=getElemById("p-"+s),i=getElemById(`e-${o}-a`),p=getElemById(`p-${s}-a`),c=o,y=s,d*=-1,v+=100):(r=getElemById("p-"+o),g=getElemById("e-"+s),i=getElemById(`e-${s}-a`),p=getElemById(`p-${o}-a`),c=s,y=o,u*=-1,h=-50,S+=100),processingAttackAction+=2,tween(r,{delay:0,duration:300,easing:1,from:{y:0},to:{y:u},onend(e){const t=Date.now();let a=calculateAttackDamage("player"==n,o,s);const l=gameState[12][y],d=gameState[10][c];"player"==n?gameState[11][c]>a?gameState[11][c]-=a:(a-=gameState[11][c],gameState[10][c]-=1,gameState[10][c]-=m.floor(a/units[c][7]),gameState[10][c]=m.max(0,gameState[10][c]),gameState[11][c]=a-m.floor(a/units[c][7])*units[c][7]):gameState[13][y]>a?gameState[13][y]-=a:(a-=gameState[13][y],gameState[12][y]-=1,gameState[12][y]-=m.floor(a/units[y][7]),gameState[12][y]=m.max(0,gameState[12][y]),gameState[13][y]=a-m.floor(a/units[y][7])*units[y][7]);let k=calculateAttackDamage("enemy"==n,s,o);"enemy"==n?gameState[11][c]>k?gameState[11][c]-=k:(k-=gameState[11][c],gameState[10][c]-=1,gameState[10][c]-=m.floor(k/units[c][7]),gameState[10][c]=m.max(0,gameState[10][c]),gameState[11][c]=k-m.floor(k/units[c][7])*units[c][7]):gameState[13][y]>k?gameState[13][y]-=k:(k-=gameState[13][y],gameState[12][y]-=1,gameState[12][y]-=m.floor(k/units[y][7]),gameState[12][y]=m.max(0,gameState[12][y]),gameState[13][y]=k-m.floor(k/units[y][7])*units[y][7]),p.innerHTML=formatNumber(gameState[12][y],!0),i.innerHTML=formatNumber(gameState[10][c],!0),gameState[12][y]<=0&&getElemById(`p-${y}-b`).classList.add("af"),gameState[10][c]<=0&&getElemById(`e-${c}-b`).classList.add("af");let f,b=0,w=0;"player"==n?(b=gameState[10][c]-d,w=gameState[12][y]-l,f=m.abs(b)):(b=gameState[12][y]-l,w=gameState[10][c]-d,f=m.abs(w)),gameState[52]&&monsterGruntSound[getRandomInt(0,5)].play(),addPlayerExperience(f*units[c][9]),w<0?(insertHtml(r,"beforebegin",`<span id="e-${t}" class="ba">${formatNumber(w,!0)}</span>`),tween(getElemById("e-"+t),{delay:v,duration:1750,easing:0,from:{opacity:1,y:0},to:{opacity:0,y:-1*h},onend(e){e&&e.remove(),processingAttackAction-=1,resetAttackButton()}})):(processingAttackAction-=1,resetAttackButton()),b<0?(insertHtml(g,"afterend",`<span id="p-${t}" class="ba">${formatNumber(b,!0)}</span>`),tween(getElemById("p-"+t),{delay:S,duration:1750,easing:0,from:{opacity:1,y:0},to:{opacity:0,y:h},onend(e){e&&e.remove(),processingAttackAction-=1,resetAttackButton()}})):(processingAttackAction-=1,resetAttackButton()),tween(e,{delay:0,duration:700,easing:2,from:{y:u},to:{y:0},onend(e){doAnAttack()}})}}),tween(g,{delay:100,duration:250,easing:1,from:{y:0},to:{y:d},onend(e){tween(e,{delay:0,duration:650,easing:2,from:{y:d},to:{y:0}})}})};const startBattle=()=>{inBattle=!0,gameState[52]&&startFightSound.play(),attackElement.classList.add("bc"),attackElement.innerHTML="<span>Stop Battle!</span>",unitToRestoreGeneration=gameState[17],generateUnit(null),setupAllBattleUnitsBySpeed(),doAnAttack(),resetAttackButton()},attack=()=>{if(processingAttackAction>0)return attackElement.classList.add("bc"),attackElement.innerHTML="<span>Stopping Battle...</span>",void stopBattle();inBattle?stopBattle():(inBattle=!0,gameState[52]&&startFightSound.play(),attackElement.classList.add("bc"),attackElement.innerHTML="<span>Stop Battle!</span>",unitToRestoreGeneration=gameState[17],generateUnit(null),setupAllBattleUnitsBySpeed(),doAnAttack(),resetAttackButton())},setBuyAmount=(e,t)=>{const a=getElemBySelector(".o");for(let e=0;e<getLength(a);e++)a[e].classList.remove("n");document.querySelectorAll(`.o[data-id='${e.dataset.id}']`).forEach(e=>{e.classList.add("n")}),gameState[38]=t,gameState[52]&&changeTabSound[getRandomInt(0,4)].play(),renderPlayerSkills()},update=e=>{if(addPlayerGold(10*m.pow(gameState[22],gameState[9])*e*.001),addPlayerUnitGenerationProgress(e),gameState[12][2]>0&&gameState[9]>0){let t=1;gameState[46][2]>=51&&(t=Math.pow(gameState[46][2],2)*Math.pow(gameState[9],2)),addPlayerExperience(1e-7*gameState[12][2]*t*m.max(1,gameState[9]/100)*e)}},draw=()=>{renderUnitGenerationProgress()},loop=e=>{const t=e-lastRender;e>nextSaveAt&&(saveGame(gameState),renderTrophies(),nextSaveAt=e+3e4),update(t),renderUnitGenerationProgress(),lastRender=e,requestAnimationFrame(loop)},unlockThemes=()=>{gameState[33]=!0,document.body.classList.add("i");const e=getElemById("m");e&&e.remove(),saveGame(gameState)},switchTheme=(e,t=null)=>{if(null!=t&&t.preventDefault(),gameState[52]&&chooseNewSkillSound.play(),setStyle(getElemById("uu"),"opacity",gameState[34]?.1:1),setStyle(getElemById("tt"),"opacity",gameState[34]?1:.1),1==gameState[33])e&&(gameState[34]=!gameState[34],saveGame(gameState),location.reload());else if(null!=t)if(confirm("这是高级游戏主题！ 重定向到coil.com 以获得会员资格？")){open("https://coil.com/?ref=spirit-dungeons","_blank").focus()}else t.preventDefault()};let stopMusic=null;const turnMusicOn=()=>{gameState[52]=!0,document.getElementById("sound-is-on").style.display="flex",document.getElementById("sound-is-off").style.display="none",stopMusic&&clearTimeout(stopMusic),backgroundMusic.play(),backgroundMusic.fade(backgroundMusic.volume(),.5,1500)},turnMusicOff=()=>{gameState[52]=!1,document.getElementById("sound-is-on").style.display="none",document.getElementById("sound-is-off").style.display="flex",backgroundMusic.fade(backgroundMusic.volume(),0,500),stopMusic=setTimeout(()=>{backgroundMusic.pause()},500)},setup=()=>{if(gameState=loadGame(!1),0==getLength(gameState[10])){gameState[10]=getEnemyLevels(gameState[9]+1);for(let e=0;e<getLength(gameState[10]);e++)0==gameState[10][e]?gameState[11][e]=0:gameState[11][e]=units[e][7]}gameState[36]||(gameState[36]=0,gameState[37]=0),gameState[38]||(gameState[38]=1),gameState[39]||(gameState[39]=[!1,!1,!1,!1,!1,!1]),gameState[40]||(gameState[40]=[]),gameState[41]||(gameState[41]=[]),gameState[42]||(gameState[42]=!1),gameState[43]||(gameState[43]=!1),gameState[44]||(gameState[44]=!1),gameState[45]||(gameState[45]=[0,0,0]),gameState[46]||(gameState[46]=[0,0,0,0,0,0]),gameState[47]||(gameState[47]=[[255,255,255],[255,255,255],[255,255,255],[255,255,255],[255,255,255],[255,255,255]]),gameState[48]||(gameState[48]=[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]]),gameState[49]||(gameState[49]=0),gameState[50]||(gameState[50]=0),gameState[51]||(gameState[51]=!1),gameState[52]||(gameState[52]=!1),gameState[53]||(gameState[53]={"red wtf":!1,"green wtf":!1,"blue wtf":!1,"wild willow":!1,"fuchsia pink":!1,"fountain blue":!1,"chelsea gem":!1,"deep blush":!1,conifer:!1,"green haze":!1,purple:!1,endeavour:!1,thunderbird:!1,"screamin' green":!1,"cornflower blue":!1,"silver chalice":!1,"the portal":!1,"the enemy":!1,"the hound":!1,"the rainbow":!1}),gameState[54]||(gameState[54]=!1),gameState[55]||(gameState[55]=!1),0==gameState[55]&&(gameState[55]=!0,gameState[53]={"red wtf":!1,"green wtf":!1,"blue wtf":!1,"wild willow":!1,"fuchsia pink":!1,"fountain blue":!1,"chelsea gem":!1,"deep blush":!1,conifer:!1,"green haze":!1,purple:!1,endeavour:!1,thunderbird:!1,"screamin' green":!1,"cornflower blue":!1,"silver chalice":!1,"the portal":!1,"the enemy":!1,"the hound":!1,"the rainbow":!1});for(let e=0;e<getLength(gameState[14]);e++)gameState[14][e]<=0&&(gameState[14][e]=0);insertHtml(getElemById("uu"),afterbegin,uiIcons.level.replace("<path ",'<path fill="#4d85b9" ')),insertHtml(getElemById("tt"),afterbegin,premiumIcons.level),navSkillsElement=getElemById("aa"),navMoralityElement=getElemById("gg"),navTrophiesElement=getElemById("ff"),navInfoElement=getElemById("info"),gameState[34]?(insertHtml(getElemById("y"),afterbegin,premiumIcons.gold),insertHtml(getElemById("r"),afterbegin,premiumIcons.level),insertHtml(navSkillsElement,afterbegin,`<strong>${premiumIcons.book}</strong>`),insertHtml(getElemById("z"),afterbegin,`<strong>${premiumIcons.battle}</strong>`),insertHtml(navMoralityElement,afterbegin,`<strong>${premiumIcons.morality}</strong>`),insertHtml(navTrophiesElement,afterbegin,`<strong>${premiumIcons.trophy}</strong>`),insertHtml(navInfoElement,afterbegin,`<strong>${premiumIcons.info}</strong>`)):(insertHtml(getElemById("y"),afterbegin,uiIcons.gold.replace("<path ",'<path fill="#c7aa0a" ')),insertHtml(getElemById("r"),afterbegin,uiIcons.level.replace("<path ",'<path fill="#4d85b9" ')),insertHtml(navSkillsElement,afterbegin,uiIcons.book),insertHtml(getElemById("z"),afterbegin,uiIcons.battle),insertHtml(navMoralityElement,afterbegin,uiIcons.morality),insertHtml(navTrophiesElement,afterbegin,uiIcons.trophy),insertHtml(navInfoElement,afterbegin,uiIcons.info)),tabContent[0]=getElemById("battle"),tabContent[1]=getElemById("skills"),tabContent[2]=getElemById("morality"),tabContent[3]=getElemById("nn"),tabContent[4]=getElemById("info-content"),unlockTabs(),player=getElemById("h"),enemy=getElemById("enemy"),playerGoldPerSecondElement=getElemById("b"),playerCurrentGoldElement=getElemById("a"),playerCurrentLevelElement=getElemById("s"),playerNextLevelProgressElement=getElemById("f"),stageCurrentElement=getElemById("rr"),battleBlockElement=getElemById("ss"),attackAttributeValueElement=getElemById("u"),defenseAttributeValueElement=getElemById("v"),addEvent(getElemById("w"),click,()=>{addAttribute(0)}),addEvent(getElemById("x"),click,()=>{addAttribute(1)}),attributeBlockElement=getElemById("q"),skillTitleElement=getElemById("pp"),skillLockElement=getElemById("g"),trophyListElement=getElemById("j"),trophyTitleElement=getElemById("mm"),addEvent(skillLockElement,click,e=>{let t=e.target.closest(".ac");t&&pickSkill(t.dataset.id),t=e.target.closest(".ab"),t&&upgradeSkill(t.dataset.id)}),addEvent(document.getElementById("info-tab"),click,e=>{openInfoTab("info-tab")}),addEvent(document.getElementById("export"),click,e=>{openInfoTab("export")}),addEvent(document.getElementById("import"),click,e=>{openInfoTab("import")}),addEvent(document.getElementById("hard-reset"),click,e=>{openInfoTab("hard-reset")}),addEvent(document.getElementById("copy-save"),click,e=>{const t=document.getElementById("current-save");t.select(),t.setSelectionRange(0,99999),document.execCommand("copy"),gameState[52]&&chooseNewSkillSound.play(),document.getElementById("copy-save").innerText="Copied!",setTimeout(()=>{document.getElementById("copy-save").innerText="Copy"},3e3)}),addEvent(document.getElementById("load-game"),click,e=>{let t=document.getElementById("new-save");if(t=t.value,!(t.length<=0)){try{t=window.atob(t),t=JSON.parse(t)}catch(e){return}Array.isArray(t)&&(gameState[52]&&chooseNewSkillSound.play(),openPopUpConfirm("All current game progress will be LOST! Are you sure?","No","Yes",()=>{saveGame(t),lockSaving=!0,location.reload(),closePopUp()}))}}),addEvent(document.getElementById("hard-reset-game"),click,e=>{gameState[52]&&chooseNewSkillSound.play(),openPopUpConfirm("All current game progress will be LOST! Are you sure?","No","Yes",()=>{saveGame(JSON.parse(JSON.stringify(initialGameState.slice()))),lockSaving=!0,location.reload(),closePopUp()})}),addEvent(document.getElementById("t1-tab"),click,e=>{openTrophyTierTab(1)}),addEvent(document.getElementById("t2-tab"),click,e=>{openTrophyTierTab(2)}),addEvent(document.getElementById("t3-tab"),click,e=>{openTrophyTierTab(3)}),addEvent(player,click,e=>{const t=e.target.closest(".eb");if(t){const e=t.dataset.id;t&&e<getLength(gameState[12])&&generateUnit(e)}}),attackElement=getElemById("zz"),addEvent(attackElement,click,()=>{attack(attackElement)}),addEvent(getElemById("hh"),click,()=>{gameState[52]&&chooseNewSkillSound.play(),closePopUp()}),addEvent(getElemById("bigPopUpClose"),click,()=>{gameState[52]&&chooseNewSkillSound.play(),closePopUp()}),addEvent(getElemById("popUpConfirmationClose"),click,()=>{gameState[52]&&chooseNewSkillSound.play(),closePopUp()}),addEvent(getElemById("select-unit-to-upgrade"),click,e=>{const t=e.target.closest(".upgradable-unit");if(t){gameState[52]&&changeTabSound[getRandomInt(0,4)].play();const e=t.dataset.id;gameState[49]=e,renderUnitToUpgrade()}}),addEvent(document.querySelector(".color-souls"),click,e=>{const t=e.target.closest(".color-soul");if(t){const e=t.dataset.id,a=Math.min(gameState[45][e],gameState[38]),l=Math.max(0,Math.min(a,51-gameState[48][gameState[49]].reduce((e,t)=>e+t,0)));gameState[45][e]>0&&(gameState[52]&&monsterGruntSound[getRandomInt(0,5)].play(),gameState[48][gameState[49]].reduce((e,t)=>e+t,0)<51&&(gameState[48][gameState[49]][e]+=l,0==e?(gameState[47][gameState[49]][1]-=5*l,gameState[47][gameState[49]][2]-=5*l):1==e?(gameState[47][gameState[49]][0]-=5*l,gameState[47][gameState[49]][2]-=5*l):2==e&&(gameState[47][gameState[49]][0]-=5*l,gameState[47][gameState[49]][1]-=5*l),gameState[48][gameState[49]].reduce((e,t)=>e+t,0)>=51&&trophiesTier3.forEach(e=>{if(!gameState[53][e.key])if(e.type==trophyKey.color)e.value[0]==gameState[48][gameState[49]][0]&&e.value[1]==gameState[48][gameState[49]][1]&&e.value[2]==gameState[48][gameState[49]][2]&&(gameState[53][e.key]=!0,renderTrophies());else if(e.type==trophyKey.colorTwo){let t=0;for(let a=0;a<e.value.length;a++)for(let l=0;l<gameState[48].length;l++)if(e.value[a][0]==gameState[48][l][0]&&e.value[a][1]==gameState[48][l][1]&&e.value[a][2]==gameState[48][l][2]){t+=1;break}t>=2&&(gameState[53][e.key]=!0,renderTrophies())}else if(e.type==trophyKey.colorAll){let t=0;for(let a=0;a<e.value.length&&(e.value[a][0]==gameState[48][a][0]&&e.value[a][1]==gameState[48][a][1]&&e.value[a][2]==gameState[48][a][2]);a++)t+=1;t>=6&&(gameState[53][e.key]=!0,renderTrophies())}})),gameState[46][gameState[49]]+=a,gameState[45][e]-=a,lastMoralityNotification=gameState[45].reduce((e,t)=>e+t,0),renderMorality(),inBattle||(renderPlayerUnits(),generateUnit(unitToRestoreGeneration)))}}),addEvent(getElemById("clear-colors"),click,e=>{gameState[52]&&chooseNewSkillSound.play(),openPopUpConfirm("This will erase all souls from this unit but will keep the attack and defense bonus","Cancel","OK",()=>{gameState[47][gameState[49]][0]=255,gameState[47][gameState[49]][1]=255,gameState[47][gameState[49]][2]=255,gameState[48][gameState[49]][0]=0,gameState[48][gameState[49]][1]=0,gameState[48][gameState[49]][2]=0,renderMorality(),closePopUp()})}),lastTrophyNotification=getLength(gameState[23])+getLength(gameState[40])+getLength(gameState[41]),lastMoralityNotification=gameState[45].reduce((e,t)=>e+t,0),renderPlayerCurrentGold(),renderPlayerGoldPerSecond(),renderPlayerLevel(),renderPlayerNextLevelProgress(),openStage(gameState[9]),generateUnit(gameState[17]),renderUnitGenerationProgress(),renderPlayerAttributes(),unlockSkills(),pickSkill(null),upgradeSkill(null),renderMorality();const e=getElemBySelector(".o");let t=3;1==gameState[38]&&(t=0),10==gameState[38]&&(t=1),50==gameState[38]&&(t=2),setBuyAmount(e[t],gameState[38]),unitToRestoreGeneration=gameState[17],update(Date.now()-gameState[3]),attack(),renderTrophies(),addLockIcon(".c"),firstGameLockDone=!0,openPopUp("loading"),closePopUp(),navElements=getElemBySelector("#nav a");for(let e=0;e<getLength(navElements);e++)addEvent(navElements[e],click,t=>{openTab(navElements[e],t,e)});for(let t=0;t<getLength(e);t++)addEvent(e[t],click,e=>{e.preventDefault(),setBuyAmount(e.target,e.target.dataset.id)});addEvent(document,click,e=>{const t=e.target.closest(".kk");if(e.target&&t){gameState[52]&&changeTabSound[getRandomInt(0,4)].play();let e=t.dataset.title;t.dataset.name&&"undefined"!=t.dataset.name&&(e=`<strong>${t.dataset.name}</strong><br>${t.dataset.title}`),e=e.replace(/rrr(.+?)rrr/g,'<span class="redColorText">$1</span>'),e=e.replace(/ggg(.+?)ggg/g,'<span class="greenColorText">$1</span>'),e=e.replace(/bbb(.+?)bbb/g,'<span class="blueColorText">$1</span>'),openPopUp(e)}}),addEvent(document.getElementById("unitInfo"),click,e=>{gameState[52]&&chooseNewSkillSound.play();let t='<div id="unitDescription">';for(let e=0;e<gameState[12].length;e++){t+="<div>",t+=`<div class="unitDescriptionIcon">${units[e][0]}</div>`,t+=`<h1 class="unitDescriptionName">${units[e][10]}</h1>`,t+=`<p class="unitDescriptionName" style="color: ${trophyColors[e]}">${units[e][11]}</p>`,t+='<div class="unitDescriptionRow">',t+=`<div class="unitDescriptionAttack" data-tippy-arrow="false" data-tippy-content="Current Damage (Base: ${units[e][5]} - ${units[e][6]})"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><g transform="translate(0,0)" style="touch-action: none;"><path d="M296.625 25.406c-63.794.388-135.81 14.683-206.03 32.844-3.472 34.08 2.226 68.906 14.03 104.25C181.175 75.936 393.65 44.825 486.72 128 456.02 50.466 384.046 24.874 296.624 25.406zM65.655 61.438L27.906 71c5.643 78.022 28.546 132.393 60.44 174.47-16.54 10.348-40.693 19.673-68.782 26.843 5.664 6.597 14.25 16.18 30.53 18.53 24.846-4.33 39.912-14.982 53.75-26.593 76.24 85.145 190.22 118.955 253.126 224.22l49.436-.126C290.996 275.316 81.01 364.804 65.656 61.438z" fill="#e36262" fill-opacity="1"></path></g></svg><span style="white-space: nowrap;">${formatNumber(units[e][5]*(1+(gameState[36]+gameState[6]+units[e][3]-.05*units[e][4])*(1+.01*gameState[46][e]))*getSkillBonus(null,skillKey.wrath,!0)*getSkillBonus(null,e+5,!0)*gameState[12][e],!0)} - ${formatNumber(units[e][6]*(1+(gameState[36]+gameState[6]+units[e][3]-.05*units[e][4])*(1+.01*gameState[46][e]))*getSkillBonus(null,skillKey.wrath,!0)*getSkillBonus(null,e+5,!0)*gameState[12][e],!1)}</span></div>`;let a=1;getLength(gameState[23])==getLength(trophies)?(a=m.max(.025,units[e][3]-(units[e][4]+gameState[36]+gameState[7])*(1+.01*gameState[46][e])*.025*getSkillBonus(null,skillKey.calm,!0)+1),a=a<.026?(100*m.min(.025,100/(m.abs(units[e][3]-(units[e][4]+gameState[36]+gameState[7])*(1+.01*gameState[46][e]))*getSkillBonus(null,skillKey.calm,!0)))).toFixed(10):(100*a).toFixed(2)):a=(100*m.max(.025,units[e][3]-(units[e][4]+gameState[36]+gameState[7])*(1+.01*gameState[46][e])*.025*getSkillBonus(null,skillKey.calm,!0)+1)).toFixed(2),t+=`<div class="unitDescriptionDefense" data-tippy-arrow="false" data-tippy-content="Taken Damage Reduced To"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><g transform="translate(0,0)" style="touch-action: none;"><path d="M111.9 33.4c24.8 45.04 23.8 88 8.4 124.5-16.3 38.6-47.47 70.4-78.91 94.6 1.8 12.4 11.15 31.8 26.2 52.9 16.81 23.7 40.01 49.9 64.81 74.6 24.7 24.8 51 48.1 73.9 66.1 21.1 16.5 39.6 28.2 49.7 32.5 10.1-4.3 28.6-16 49.7-32.5 22.9-18 49.2-41.3 73.9-66.1 24.8-24.7 48-50.9 64.8-74.6 15.1-21.1 24.4-40.5 26.2-52.9-31.4-24.2-62.6-56-78.9-94.6-15.4-36.5-16.4-79.46 8.4-124.5H354c-64.8 31.74-131.2 31.74-196 0zm49.2 46h49l1.9.95c22.1 11.01 33.7 15.75 44 15.75 10.3 0 21.9-4.74 44-15.75l1.9-.95h49l-1.6 10.38c-11.9 76.52 25 129.12 67.5 161.02l3.6 2.7v4.5c0 15.2-8.9 30.9-21.3 48.3-12.4 17.5-29 36.1-46.5 53.7-17.6 17.6-36.2 34.1-52.7 47-16.5 13-30 22.3-41.1 25.9l-2.8 1-2.8-1c-11.1-3.6-24.6-12.9-41.1-25.9-16.4-12.9-35-29.4-52.6-47s-34.2-36.2-46.6-53.7c-12.4-17.4-21.19-33.1-21.19-48.3v-4.5l3.59-2.7c42.4-31.9 79.4-84.5 67.4-161.01zm20.6 18c7.9 75.5-28.9 130.8-71.3 164.4 1.5 7.8 7.4 20.3 17.2 34.1 11.5 16.2 27.6 34.3 44.6 51.4 17.1 17.1 35.3 33.2 51 45.6 13.9 10.8 26.1 18.6 32.8 21.6 6.7-3 18.9-10.8 32.8-21.6 15.8-12.4 33.9-28.5 51-45.6s33.1-35.2 44.7-51.4c9.8-13.8 15.7-26.3 17.2-34.1-42.5-33.6-79.2-88.9-71.4-164.4h-24.2c-21.2 10.5-35.1 16.7-50.1 16.7s-28.9-6.2-50.1-16.7zm74.3 26.3l44.7 44.7-44.7 44.7-44.7-44.7 38.3-38.4zm0 25.4l-19.3 19.3 19.3 19.3 19.3-19.3zm0 86.6l76.7 76.7-76.7 76.7-76.7-76.7 70.3-70.4zm0 25.4l-51.3 51.3 51.3 51.3 51.3-51.3z" fill="#4d85b9" fill-opacity="1"></path></g></svg><span style="white-space: nowrap;">${a}%</span></div>`;let l=(Math.floor(units[e][2]/100)/10).toFixed(1);l>10&&(l=Math.floor(l));const n=m.max(.1,1-.01*getSkillBonus(null,skillKey.necromancy));let o=m.max(.01,1-m.pow(gameState[9]+1,2)/24e3),s=!1;for(let e=0;e<gameState[15].length;e++)if(gameState[15][e]==skillKey.necromancy){s=!0;break}s||(o=1);const r=[];for(let e=0;e<units.length;e++){let t=1;for(let a=0;a<gameState[15].length;a++)if(gameState[15][a]>=5&&gameState[15][a]==e+5){t=1/gameState[16][a]*(e+1)*10;break}r.push(t)}let i=0;0==e&&gameState[12].length>=5&&gameState[12][4]>0&&(i+=1e3*gameState[12][4]*5e-4),gameState[39][e]&&(i+=250);let g=i/(units[e][2]*n*r[e]*o);gameState[17]==e&&(g+=1e3/(units[e][2]*n*r[e]*o)),g=g>=10?formatNumber(g):g.toFixed(2),t+=`<div class="unitDescriptionTime" data-tippy-arrow="false" data-tippy-content="Time to Generate (Base: 1 per ${l} sec)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><g transform="translate(0,0)" style="touch-action: none;"><path d="M247 62.107v9.94h-28.88v18H247v39.074c-84.367 4.682-151.514 74.737-151.514 160.26 0 41.037 15.468 78.508 40.873 106.91l-36.237 36.237 12.727 12.73 36.238-36.24C177.49 434.425 214.96 449.894 256 449.894c41.04 0 78.51-15.47 106.912-40.875l36.238 36.238 12.727-12.73-36.236-36.235c25.406-28.402 40.874-65.873 40.874-106.91 0-85.523-67.147-155.578-151.514-160.26V90.048h28.88v-18H265v-9.94h-18zm-104.906 26.58c-3.583-.03-7.267.125-11.014.465C111.1 90.97 89.15 98 73.637 113.514c-15.514 15.513-22.545 37.462-24.362 57.443-.908 9.99-.488 19.54 1.184 27.898 1.67 8.36 4.315 15.662 9.784 21.13l6.363 6.365 6.366-6.364 113.5-113.502-6.366-6.363c-5.47-5.468-12.77-8.112-21.128-9.784-4.18-.836-8.658-1.358-13.34-1.56-1.17-.05-2.352-.08-3.546-.088zm227.812 0c-1.194.01-2.376.04-3.547.09-4.682.2-9.16.723-13.34 1.56-8.357 1.67-15.658 4.315-21.127 9.784l-6.366 6.364 6.366 6.366 113.5 113.5 6.363-6.364c5.47-5.47 8.113-12.772 9.785-21.13 1.673-8.36 2.093-17.908 1.185-27.9-1.817-19.98-8.848-41.93-24.362-57.442C422.85 98 400.9 90.97 380.92 89.152c-3.747-.34-7.43-.494-11.014-.465zM256 146.865c78.815 0 142.514 63.7 142.514 142.514 0 78.814-63.7 142.513-142.514 142.513-78.815 0-142.514-63.7-142.514-142.514 0-78.816 63.7-142.515 142.514-142.515zm-88.332 41.453l-12.73 12.73 82.92 82.917a18.94 18.94 0 0 0-.797 5.414A18.94 18.94 0 0 0 256 308.317a18.94 18.94 0 0 0 16.66-9.94h59.096v-18h-59.11A18.94 18.94 0 0 0 256 270.44a18.94 18.94 0 0 0-5.408.804l-82.924-82.924z" fill="#c7aa0a" fill-opacity="1"></path></g></svg><span style="white-space: nowrap;">${g} p/sec</span></div>`,t+=`<div class="unitDescriptionHealth" data-tippy-arrow="false" data-tippy-content="Base Health"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><g transform="translate(0,0)" style="touch-action: none;"><path d="M374.688 33.78c-40.753-.25-82.475 21.226-109.22 71.782l-7.906 14.938-8.468-14.656c-32.643-56.628-91.52-77.628-141.406-67.813C57.801 47.848 17.09 87.075 19.31 157.126c1.276 40.232 18.886 72.314 44.876 102.063 7.425-19.163 12.86-40.794 16.218-64.844l.03-.188.033-.22c3.27-17.58 16.133-28.45 29.405-29.31 1.896-.124 3.8-.046 5.688.25 14.87 2.323 27.108 17.422 24.718 36.593v.06l-.03.064c-5.195 37.19-15.408 71.8-30.72 102.125 3.552 3.154 7.14 6.32 10.782 9.5 2.316 2.018 4.72 4.062 7.063 6.092 10.018-2.448 20.884-6.123 32.313-10.812.433.697.875 1.395 1.343 2.094l9.626 14.375c-8.86 3.69-17.542 6.848-25.97 9.374 42.482 36.955 86.22 77.407 112.75 132.437 16.882-33.235 40.17-60.668 65.502-85.124-1.818-1.453-3.493-3.138-4.97-5.062-8.02-10.457-7.668-24.424-2.718-37s14.513-24.804 27.563-34.813c13.05-10.008 27.32-16.04 40.75-17.56 3.357-.38 6.713-.476 10-.22 9.74.76 18.796 4.505 24.812 12.156 19.22-17.21 36.378-34.68 49.406-53.625 17.402-25.3 27.682-52.99 26.595-87.843-1.426-45.725-22.027-80.43-50.906-101.312-1.27 10.676-4.632 21.77-9.626 33.156-.075-.05-.144-.105-.22-.155l-15.874-10.53c5.078-12.455 7.72-23.76 7.563-33.25-7.31-3.52-14.927-6.292-22.75-8.25-9.104-2.28-18.47-3.506-27.875-3.564zm13.656 53.126c3.786-.046 10.03 1.552 17.875 6.75l17.092 11.313c12.656 8.387 12.5 16.663 10.97 19.28-.766 1.308-1.8 2.333-5.126 2.5-3.325.167-9.003-1.103-16.344-5.97l-17.062-11.31c-7.25-4.806-11.08-9.825-12.625-13.532-1.545-3.708-1.003-5.742-.344-6.813.66-1.07 1.778-2.172 5.564-2.22zM113.313 124.47c21.762.174 42.915 11.463 54.562 31.5 16.498 28.38 8.087 64.472-18.313 83.03l6.375-38.844c3.358-11.243 2.193-23.783-4.218-34.812-7.748-13.327-21.324-21.163-35.657-22.156-1.076-.075-2.17-.098-3.25-.094-7.57.023-15.222 1.952-22.282 6-12.853 7.37-20.63 19.956-22.155 33.437l-8.22 39.97c-.745-1.114-1.472-2.232-2.155-3.406-17.49-30.085-7.028-68.875 23.22-86.22 9.45-5.42 19.773-8.12 30-8.374.702-.018 1.39-.037 2.093-.03zm275.937 3.155l13.25 8.75c.805.534 1.607 1.013 2.406 1.5-7.525 10.237-15.925 20.55-25.03 30.844l-13.845-12.564c8.468-9.582 16.27-19.135 23.22-28.53zm-55.563 32.188c.66-.03 1.438.025 2.375.156 3.75.522 9.684 3.023 16.657 9.343l2.686 2.437 12.5 11.344c11.25 10.196 9.845 18.36 7.938 20.72-.954 1.177-2.125 2.02-5.438 1.686-3.312-.335-8.724-2.43-15.25-8.344l-15.187-13.75c-6.445-5.84-9.47-11.383-10.44-15.28-.97-3.9-.125-5.822.69-6.782.61-.72 1.487-1.443 3.467-1.53zM110.78 183.188c-4.597.032-9.852 2.955-11.936 14.156-9.634 68.432-36.04 121.17-79.03 153.25l-.002 26.562C76.6 342.28 110.698 278.136 121.75 199c1.323-11.076-3.913-14.852-9.063-15.656-.62-.097-1.25-.16-1.906-.156zM326.595 196.5c.27.252.536.5.812.75l13.063 11.813c-7.305 6.834-14.808 13.584-22.5 20.187-3.396 2.914-6.833 5.797-10.283 8.656L295.47 223.78c3.48-2.862 6.933-5.76 10.342-8.686 7.095-6.09 14.036-12.303 20.782-18.594zm-64.563 27.063c.826-.033 1.88.104 3.25.468 3.66.972 9.278 4.17 15.44 11.282l13.405 15.47c9.94 11.476 7.583 19.42 5.406 21.53-1.087 1.055-2.376 1.764-5.624 1.032-3.248-.732-8.36-3.47-14.125-10.125l-13.436-15.47c-5.694-6.574-8.007-12.42-8.5-16.406-.494-3.987.577-5.833 1.5-6.688.46-.427 1.023-.825 1.937-1 .23-.043.476-.083.75-.094zm-11.624 34.218c.585.732 1.182 1.46 1.813 2.19l10.686 12.31c-13.854 9.792-27.824 18.895-41.687 27.064-.605-1.04-1.25-2.066-1.94-3.094l-8.81-13.125c13.187-7.64 26.598-16.143 39.936-25.344zM174.5 275.69c.928-.06 2.182.136 3.938.843 3.51 1.416 8.668 5.277 13.906 13.095l11.406 17.03c8.45 12.615 5.14 20.207 2.72 22.033-1.21.912-2.586 1.438-5.72.312s-7.88-4.465-12.78-11.78l-11.407-17c-4.84-7.227-6.408-13.328-6.407-17.345.002-4.017 1.26-5.703 2.28-6.438.512-.367 1.136-.688 2.064-.75zm214.47 29.843c-1.06.03-2.157.12-3.314.25-9.257 1.05-20.83 5.685-31.47 13.845-10.638 8.16-18.118 18.144-21.53 26.813-3.412 8.668-2.755 14.985.156 18.78 2.912 3.796 8.806 6.048 18.063 5 1.926-.217 3.964-.6 6.063-1.124-3.063-8.48-2.586-17.12 1.03-24 5.506-10.474 16.72-16.732 28.72-16.375 5.37.158 10.643 1.827 15.468 4.717.667-1.31 1.253-2.612 1.75-3.875 3.412-8.67 2.755-14.954-.156-18.75-2.183-2.845-6.042-4.846-11.75-5.218-.95-.062-1.972-.092-3.03-.063zm-3.783 41.876c-4.623.21-8.865 2.97-10.656 6.375-1.897 3.613-2.527 8.145 4.064 15.69 27.222 28.585 69.735 53.89 116.28 64.28v-25.5c-39.302-10.528-75.917-32.2-98.5-55.844-3.69-3.612-7.17-4.908-10.25-5-.31-.01-.628-.014-.937 0z" fill="#da3f3f" fill-opacity="1"></path></g></svg><span style="white-space: nowrap;">${formatNumber(units[e][7])}</span></div>`,t+="</div>",t+="</div>"}t+="</div>",openBigPopUp(t),tippy("[data-tippy-content]",{duration:0,arrow:!1})}),addEvent(document.getElementById("statInfo"),click,e=>{gameState[52]&&chooseNewSkillSound.play();let t='<div id="statInfoContent">';t+="<p><strong>Attack</strong> increases your Damage by 5%</p>",t+="<p><strong>Defense</strong> reduces Damage you take by 2.5%</p>",t+="<p><strong>Wrath</strong> increases your Damage by 5%</p>",t+="<p><strong>Calm</strong> reduces Damage you take by 2.5%</p>",t+="<p><strong>Prosperity</strong> increases your Gold Gain by 5%</p>",t+="<p><strong>Learning</strong> increases your EXP Gain by 2.5%</p>",t+="<p><strong>Necromancy</strong> speeds up your Unit Production by 1% that scales with stage you're in but isn't shown in UI</p>",t+="<p><strong>Skeleton</strong> increases their Attack by 5% and speeds up their generation time</p>",t+="<p><strong>Zombie</strong> increases their Attack by 5% and speeds up their generation time</p>",t+="<p><strong>Wight</strong> increases their Attack by 5% and speeds up their generation time</p>",t+="<p><strong>Vampire</strong> increases their Attack by 5% and speeds up their generation time</p>",t+="<p><strong>Grim Reaper</strong> increases their Attack by 5% and speeds up their generation time</p>",t+="<p><strong>Bone Dragon</strong> increases their Attack by 5% and speeds up their generation time</p>",t+="</div>",openBigPopUp("<div id=\"statInfoContent\"><p><strong>Attack</strong> increases your Damage by 5%</p><p><strong>Defense</strong> reduces Damage you take by 2.5%</p><p><strong>Wrath</strong> increases your Damage by 5%</p><p><strong>Calm</strong> reduces Damage you take by 2.5%</p><p><strong>Prosperity</strong> increases your Gold Gain by 5%</p><p><strong>Learning</strong> increases your EXP Gain by 2.5%</p><p><strong>Necromancy</strong> speeds up your Unit Production by 1% that scales with stage you're in but isn't shown in UI</p><p><strong>Skeleton</strong> increases their Attack by 5% and speeds up their generation time</p><p><strong>Zombie</strong> increases their Attack by 5% and speeds up their generation time</p><p><strong>Wight</strong> increases their Attack by 5% and speeds up their generation time</p><p><strong>Vampire</strong> increases their Attack by 5% and speeds up their generation time</p><p><strong>Grim Reaper</strong> increases their Attack by 5% and speeds up their generation time</p><p><strong>Bone Dragon</strong> increases their Attack by 5% and speeds up their generation time</p></div>")}),addEvent(document.getElementById("moralityInfo"),click,e=>{gameState[52]&&chooseNewSkillSound.play();let t='<div id="moralityInfoContent">';t+="<p>Each soul you infuse in your unit raises its base attack and defense stats by 1% as well as changes the color of the unit based on which color soul you infuse</p>",t+="<p>When 51 souls have been infused - color won't change anymore but souls will still be consumed to increase attack and defense stats by 1% for each soul</p>",t+="<p>Clearing souls from the unit only removes its color but leaves the damage bonus</p>",t+="<p>Higher stages yield higher chance to get souls</p>",t+="</div>",openBigPopUp('<div id="moralityInfoContent"><p>Each soul you infuse in your unit raises its base attack and defense stats by 1% as well as changes the color of the unit based on which color soul you infuse</p><p>When 51 souls have been infused - color won\'t change anymore but souls will still be consumed to increase attack and defense stats by 1% for each soul</p><p>Clearing souls from the unit only removes its color but leaves the damage bonus</p><p>Higher stages yield higher chance to get souls</p></div>')}),addEvent(document.getElementById("trophyInfo"),click,e=>{gameState[52]&&chooseNewSkillSound.play(),openPopUp("Each T1 trophy gives you <strong>1.5% Global Bonus (T2 - 10%, T3 - 100%)</strong> that increases your gold and experience gain as well as attack, defense and skill power!<br><br>This bonus is kept between resets (mini prestiges).")}),openTab(navElements[0],null,0),openInfoTab("info-tab"),document.getElementById("t3-tab").classList.contains("tier-locked")?document.getElementById("t2-tab").classList.contains("tier-locked")?openTrophyTierTab(1):openTrophyTierTab(2):openTrophyTierTab(3),gameState[2]=Date.now(),gameState[33]?unlockThemes():monetization&&("started"==monetization.state?unlockThemes():addEvent(monetization,"monetizationstart",()=>{unlockThemes()})),addEvent(getElemById("l"),click,e=>{switchTheme(!0,e)}),addEvent(getElemById("e"),click,()=>{gameState[52]&&chooseNewSkillSound.play(),gameState[4]<10||openPopUpConfirm("This will make things easier as you keep your attributes and trophy bonuses.<br><br>Do you want to restart now?","No","Yes",()=>{if(inBattle&&attack(),getUnusedAttributes()>0){const e=m.ceil(getUnusedAttributes()/2),t=m.floor(getUnusedAttributes()-e);gameState[6]+=e,gameState[27]+=e,gameState[7]+=t,gameState[28]+=t}const e=JSON.parse(JSON.stringify(initialGameState.slice()));e[36]=gameState[36]+gameState[6],e[37]=gameState[37]+gameState[7],e[24]=gameState[24],e[25]=gameState[25],e[26]=gameState[26],e[27]=gameState[27],e[28]=gameState[28],e[29]=gameState[29],e[30]=gameState[30],e[31]=gameState[31],e[32]=gameState[32],e[42]=gameState[42],e[43]=gameState[43],e[44]=gameState[44],e[45]=gameState[45],e[46]=gameState[46],e[47]=gameState[47],e[48]=gameState[48],e[49]=gameState[49],e[50]=gameState[50],e[51]=gameState[51],e[52]=gameState[52],e[53]=gameState[53],e[55]=gameState[55],saveLastRestart(gameState[9]+1),gameState=e,saveGame(gameState),lockSaving=!0,location.reload(),closePopUp()})}),addEvent(getElemById("sound"),click,()=>{gameState[52]?(gameState[52]=!1,document.getElementById("sound-is-on").style.display="none",document.getElementById("sound-is-off").style.display="flex",backgroundMusic.fade(backgroundMusic.volume(),0,500),stopMusic=setTimeout(()=>{backgroundMusic.pause()},500)):turnMusicOn()}),switchTheme(!1),0==gameState[51]?(gameState[51]=!0,openPopUpConfirm("Play with sound and music?","No","Yes",()=>{turnMusicOn(),closePopUp()})):gameState[52]&&turnMusicOn(),saveGame(gameState);null!=loadLastRestart()&&saveLastRestart(null),requestAnimationFrame(loop)};setup(),addEvent(window,"beforeunload",()=>{stopBattle()});
    </script>
<!--客服 开始-->
<script src="//g8hh.com/static/js/jquery.min.js"></script>
<link rel="stylesheet" href="//g8hh.com/static/css/kf.css" type="text/css" media="screen" charset="utf-8">
<script src="//g8hh.com/static/js/kf.js"></script>
<!-- 客服 结束 -->
<!--站长统计-->
    <div style="display: none">
       <script type="text/javascript" src="https://v1.cnzz.com/z_stat.php?id=1280006740&web_id=1280006740"></script>
    </div>
</body>

</html>
